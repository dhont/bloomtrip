{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"BloomTrip Documentation","text":"<p>Welcome to the BloomTrip developer &amp; product documentation.</p>"},{"location":"#sections","title":"Sections","text":"<ul> <li>Architecture: System flow, RAG pipeline, caching, Azure components.</li> <li>Specs: Core domain schemas and API endpoints.</li> <li>Roadmap: Phased delivery plan.</li> <li>Mockups: Early UX visualization (work in progress).</li> </ul>"},{"location":"#quick-start","title":"Quick Start","text":"Need Where High-level RAG flow <code>architecture/README.md</code> JSON Schemas <code>specs/*.md</code> + <code>../schemas/*.json</code> API surface <code>specs/api_endpoints.md</code> Product phases <code>roadmap.md</code>"},{"location":"#contributing","title":"Contributing","text":"<p>See <code>../CONTRIBUTING.md</code> for guidelines.</p> <p>Last updated: September 2025</p> <p>Read the Docs build pending: once the project is connected, this badge will reflect latest build status.</p>"},{"location":"01_project-overview/","title":"Project Overview","text":""},{"location":"01_project-overview/#1-problem-statement","title":"1. Problem Statement","text":"<p>Planning short trips is time-consuming. Most tools focus on long vacations, offer generic suggestions, or require juggling multiple apps for weather, events, and bookings. Existing AI planners often hallucinate, lack transparency, and ignore personal context like family composition, interests, or constraints.</p>"},{"location":"01_project-overview/#2-goal","title":"2. Goal","text":"<p>Build a weekend-trip-first planning system that:</p> <ul> <li>Suggests 2\u20134 day trips tailored to the user\u2019s profile</li> <li>Uses real-time data (events, weather, holidays, social buzz)</li> <li>Grounds all AI output in retrieved, verifiable sources</li> <li>Adapts dynamically to context (weather, long weekends, school breaks)</li> <li>Runs cost-effectively on Azure (~$150/month)</li> </ul>"},{"location":"01_project-overview/#3-market-landscape-pain-points-summary","title":"3. Market Landscape &amp; Pain Points (Summary)","text":""},{"location":"01_project-overview/#31-existing-tools-selective","title":"3.1 Existing Tools (Selective)","text":"<ul> <li>Wanderlog \u2014 Strong collaboration &amp; itinerary UX; still manual research.</li> <li>TripIt \u2014 Great for post-booking organization; not for discovery.</li> <li>Roadtrippers \u2014 Good for long road itineraries; weak for short regional getaways.</li> <li>Tripadvisor \u2014 Massive breadth; overwhelming, generic feeds.</li> <li>AI planners (Mindtrip, Layla) \u2014 Fast ideas; often ungrounded or trend-skewed.</li> </ul>"},{"location":"01_project-overview/#32-common-pain-points","title":"3.2 Common Pain Points","text":"Pain Description Generic output No deep personalization or explanation Fragmented data Weather / events / holidays separated Weekend neglect Optimized for long vacations, not short notice Overload Long, unranked POI lists with no rationale Weak feedback Little ability to refine results iteratively Hallucinations AI inventions without citations Privacy concerns Email scraping / opaque usage"},{"location":"01_project-overview/#4-competitive-feature-comparison","title":"4. Competitive Feature Comparison","text":"Feature / Capability BloomTrip (MVP) Wanderlog TripIt Roadtrippers Tripadvisor Mindtrip (AI) Weekend\u2011first focus \u2705 \u274c \u274c \u274c \u274c \u274c Profile personalization \u2705 \u26a0\ufe0f \u274c \u274c \u274c \u26a0\ufe0f Real\u2011time events integration \u2705 \u274c \u274c \u274c \u274c \u274c Weather\u2011aware suggestions \u2705 \u274c \u274c \u274c \u274c \u274c Holiday &amp; school break awareness \u2705 \u274c \u274c \u274c \u274c \u274c Social buzz integration \u2705 \u274c \u274c \u274c \u274c \u26a0\ufe0f Grounded RAG with citations \u2705 \u274c \u274c \u274c \u274c \u274c Feedback loop (Save/Boost/Mute/Skip) \u2705 \u274c \u274c \u274c \u274c \u26a0\ufe0f Prompt\u2011to\u2011adjust \u2705 \u274c \u274c \u274c \u274c \u26a0\ufe0f Multi\u2011modal content \u2705 \u26a0\ufe0f \u274c \u2705 \u2705 \u26a0\ufe0f Privacy\u2011first design \u2705 \u26a0\ufe0f \u274c (email parsing) \u274c \u274c \u274c Campervan / off\u2011grid support \u2705 \u274c \u274c \u26a0\ufe0f \u274c \u274c Cost transparency \u2705 \u274c \u274c \u274c \u274c \u274c <p>\u2705 = Strong, \u26a0\ufe0f = Partial, \u274c = Missing</p>"},{"location":"01_project-overview/#5-unique-value-proposition","title":"5. Unique Value Proposition","text":"<p>\u201cThe only weekend trip planner that blends your profile, live events, weather, and social buzz into grounded, explainable suggestions you can tweak instantly \u2014 all without giving up your privacy.\u201d</p> <p>Key differentiators:</p> <ul> <li>Context-aware personalization \u2014 Profile + live data + seasonal context</li> <li>Weekend-first focus \u2014 Optimized for short trips with intelligent long-weekend expansion</li> <li>RAG transparency \u2014 Every suggestion cites its sources (no silent hallucinations)</li> <li>Feedback-driven evolution \u2014 Save / Boost / Mute / Skip + prompt-to-adjust</li> <li>Multi-modal context \u2014 Text, maps, media (YouTube, Reddit)</li> <li>Privacy-first \u2014 OIDC login, no email scraping, managed identities only</li> </ul>"},{"location":"01_project-overview/#6-target-users","title":"6. Target Users","text":"<ul> <li>Families or individuals in Romania (initially)</li> <li>Time-constrained users wanting curated, relevant trip ideas</li> <li>Web-first users comfortable with progressive enhancement (mobile web before native)</li> </ul>"},{"location":"01_project-overview/#7-high-level-workflow","title":"7. High-Level Workflow","text":"<ol> <li>Profile setup (home base, interests, constraints, travel radius)</li> <li>Multi-source ingestion (events, weather, holidays, Reddit, YouTube)</li> <li>Enrichment (tags, seasonality, embeddings, drive time)</li> <li>Personalized retrieval (filters + vector + profile adaptation)</li> <li>ML ranking (rules + model features + diversity)</li> <li>RAG generation (grounded trip cards with rationale &amp; sources)</li> <li>Feedback + adjustment loop (immediate user vector update; nightly model refresh)</li> </ol>"},{"location":"01_project-overview/#8-why-azure","title":"8. Why Azure","text":"<ul> <li>Integrated AI (OpenAI + Cognitive Search + ML endpoints)</li> <li>Cost-efficient serverless ingestion (Functions, Logic Apps)</li> <li>Managed identity + OIDC for secretless CI/CD</li> <li>Incremental scale path (Basic SKUs \u2192 autoscale)</li> <li>Built-in geospatial (Azure Maps API)</li> </ul>"},{"location":"01_project-overview/#9-near-term-roadmap","title":"9. Near-Term Roadmap","text":"<ul> <li>Finalize requirements spec (<code>docs/02_requirements-spec.md</code>)</li> <li>Build ingestion scripts for first data sources</li> <li>Set up Azure baseline infrastructure (Bicep)</li> <li>Implement MVP retrieval + RAG pipeline</li> <li>Launch public landing (BloomTripApp.com) for alpha email capture</li> <li>Add one-pager (<code>one-pager.md</code>) to pitch materials</li> </ul> <p>Last updated: September 2025 (updated with domain &amp; one-pager references)</p>"},{"location":"02_requirements-spec/","title":"Requirements Specification (Market-Aligned)","text":""},{"location":"02_requirements-spec/#1-purpose","title":"1. Purpose","text":"<p>Defines functional and non-functional requirements for the Weekend Trip Recommender, incorporating market analysis to ensure differentiation and user value.</p>"},{"location":"02_requirements-spec/#2-functional-requirements","title":"2. Functional Requirements","text":""},{"location":"02_requirements-spec/#21-user-profile-onboarding","title":"2.1 User Profile &amp; Onboarding","text":"<ul> <li>FR-1: Capture home location, travel radius (weekend vs long weekend), interests, constraints, seasonal preferences.</li> <li>FR-2: Connect calendars (personal + public holidays + school vacations).</li> <li>FR-3: Persist and update profile for personalization.</li> </ul>"},{"location":"02_requirements-spec/#22-data-ingestion","title":"2.2 Data Ingestion","text":"<ul> <li>FR-4: Pull from weather, events, holidays, Reddit, YouTube.</li> <li>FR-5: Normalize stored data to consistent schema.</li> <li>FR-6: Enrich with geolocation, tags, popularity metrics.</li> </ul>"},{"location":"02_requirements-spec/#23-retrieval-augmented-generation-rag","title":"2.3 Retrieval-Augmented Generation (RAG)","text":"<ul> <li>FR-7: Create embeddings and store in Azure Cognitive Search.</li> <li>FR-8: Retrieve based on profile, date window, weather readiness, upcoming free days.</li> <li>FR-9: Generate trip suggestions grounded strictly in retrieved content.</li> <li>FR-10: Explain why each trip is recommended (rationale string + citations).</li> </ul>"},{"location":"02_requirements-spec/#24-personalization-ranking","title":"2.4 Personalization &amp; Ranking","text":"<ul> <li>FR-11: Rank using rule filters + ML model (initial heuristic \u2192 LightGBM/LightFM).</li> <li>FR-12: Adapt personalization from explicit (save/boost/mute/skip) + implicit (clicks/dwell) feedback.</li> </ul>"},{"location":"02_requirements-spec/#25-feedback-adjustment","title":"2.5 Feedback &amp; Adjustment","text":"<ul> <li>FR-13: Accept natural language adjustment prompts bound to an existing idea.</li> <li>FR-14: Regenerate while preserving original evidence set; cite all sources.</li> </ul>"},{"location":"02_requirements-spec/#26-frontend","title":"2.6 Frontend","text":"<ul> <li>FR-15: Display trip cards: title, why now, fit for you, plan, logistics, weather note, sources.</li> <li>FR-16: Provide filtering/sorting (distance, theme, weather suitability\u2014phase 2).</li> <li>FR-17: Let users save trips and construct itineraries (basic version).</li> </ul>"},{"location":"02_requirements-spec/#27-governance-deferred-legacy","title":"2.7 Governance (Deferred / Legacy)","text":"<ul> <li>FR-18: (Future) Admin-triggered re-index &amp; selective embedding refresh.</li> <li>FR-19: (Future) Health endpoint reporting ingestion freshness &amp; model status.</li> </ul>"},{"location":"02_requirements-spec/#3-non-functional-requirements","title":"3. Non-Functional Requirements","text":"Category ID Requirement Target Performance NFR-1 /ideas median latency \u2264 2.5s Performance NFR-2 /adjust median latency \u2264 4.0s Scalability NFR-3 Concurrent users (MVP) 100 Reliability NFR-4 Ingestion retry attempts 3 Reliability NFR-5 Graceful degradation on source failure Fallback cached set Security NFR-6 Auth OIDC (Entra ID) Security NFR-7 Data plane Private endpoints (phase 2) Cost NFR-8 Monthly Azure spend \u2264 $150 Cost NFR-9 Budget alerts 70%, 90% Observability NFR-10 Tracing coverage \u226595% of request paths Privacy NFR-11 User deletion SLA \u22647 days"},{"location":"02_requirements-spec/#4-acceptance-criteria","title":"4. Acceptance Criteria","text":"<ul> <li>AC-1: New user receives \u22655 relevant suggestions on first query.</li> <li>AC-2: Each suggestion includes at least one source + rationale.</li> <li>AC-3: After \u22653 feedback actions, ranking changes are observable (telemetry flag).</li> <li>AC-4: Adjustment returns revised plan with \u226550% changed plan block content while retaining valid sources.</li> <li>AC-5: 0% uncited factual claims in automated test sample (hallucination guardrail).</li> </ul>"},{"location":"02_requirements-spec/#5-out-of-scope-mvp","title":"5. Out of Scope (MVP)","text":"<ul> <li>Booking API integration</li> <li>Loyalty optimization</li> <li>Mobile native app</li> <li>Multi-language (beyond EN/RO)</li> <li>Advanced geospatial clustering (isochrones)</li> </ul>"},{"location":"02_requirements-spec/#6-market-driven-focus-areas","title":"6. Market-Driven Focus Areas","text":"<p>Derived from market analysis (<code>05_market-analysis.md</code>):</p> Focus Problem Solved Explainable suggestions Generic lists w/out rationale Real-time blended context Fragmented weather/event/holiday data Weekend optimization Long-vacation bias Low-friction iteration Weak feedback loops Grounded generation AI hallucinations Privacy-first Email scraping distrust"},{"location":"02_requirements-spec/#7-delivery-sequence-initial","title":"7. Delivery Sequence (Initial)","text":"<ol> <li>Finalize architecture (<code>03_architecture.md</code>)</li> <li>Implement ingestion (weather, holidays, first events source)</li> <li>Build Cognitive Search index + embedding pipeline</li> <li>Ship /profile + /ideas + basic RAG generation</li> <li>Add feedback actions + heuristic ranking; integrate ML ranker v1</li> </ol>"},{"location":"02_requirements-spec/#8-traceability","title":"8. Traceability","text":"Requirement Market Pain Mapping FR-7..FR-10 Hallucinations, generic output FR-11..FR-14 Weak feedback / iteration NFR-8..NFR-9 Cost discipline NFR-6..NFR-7 Privacy &amp; trust AC-2 / AC-5 Explainability &amp; grounding"},{"location":"02_requirements-spec/#9-change-log","title":"9. Change Log","text":"Date Change Author 2025-09-05 Market-aligned rewrite System 2025-09-05 Added traceability section System <p>Last updated: September 2025</p>"},{"location":"03_architecture/","title":"Architecture","text":""},{"location":"03_architecture/#1-overview","title":"1. Overview","text":"<p>The Weekend Trip Recommender is built on Microsoft Azure using .NET Aspire for orchestration, observability, and service composition.</p> <p>Design priorities:</p> <ul> <li>Cost-effectiveness (~$150/month target)</li> <li>Scalability (start small, grow gradually)</li> <li>Maintainability (clear separation of concerns)</li> <li>Personalization (RAG + ML ranking)</li> </ul>"},{"location":"03_architecture/#2-high-level-diagram-textual-draft","title":"2. High-Level Diagram (Textual Draft)","text":"<p>User Browser \u2192 Azure Static Web Apps (React UI) \u2192 Azure API Management (optional) \u2192 .NET Aspire Backend (App Service / Container Apps)</p> <p>Side / Downstream:</p> <ul> <li>Azure Functions (Ingestion Jobs)</li> <li>Azure Blob Storage (raw data)</li> <li>Azure Cognitive Search (vector + semantic index)</li> <li>Azure OpenAI (embeddings + RAG generation)</li> <li>Azure SQL Database (profiles, events, feedback)</li> <li>Azure Machine Learning Endpoint (ranking model)</li> <li>Azure Maps (distance, travel time)</li> </ul> <p>A rendered diagram (Mermaid) can replace this section later:</p> <p><code>mermaid flowchart LR   A[Browser / React UI] --&gt; B[SWA Frontend]   B --&gt; C[API Management]   C --&gt; D[.NET Aspire API]   D --&gt;|Query| S[Azure Cognitive Search]   D --&gt;|Generate| O[Azure OpenAI]   D --&gt;|Rank| M[Azure ML Endpoint]   D --&gt;|Profile / Feedback| Q[(Azure SQL)]   D --&gt;|Distance / Time| MAPS[Azure Maps]   subgraph Ingestion     F[Azure Functions] --&gt; BL[Blob Storage]     F --&gt; S     F --&gt; Q   end   O --&gt; S   BL --&gt; S</code></p>"},{"location":"03_architecture/#3-components","title":"3. Components","text":""},{"location":"03_architecture/#31-frontend","title":"3.1 Frontend","text":""},{"location":"03_architecture/#azure-static-web-apps","title":"Azure Static Web Apps","text":"<ul> <li>Hosts React UI</li> <li>Built-in global CDN + auth options</li> <li>Cost-efficient at low traffic</li> </ul> <p>Features:</p> <ul> <li>Profile setup wizard</li> <li>Trip suggestion feed</li> <li>Feedback buttons (save, boost, mute, skip)</li> <li>\"Prompt-to-adjust\" modal</li> </ul>"},{"location":"03_architecture/#32-backend-net-aspire","title":"3.2 Backend (.NET Aspire)","text":""},{"location":"03_architecture/#net-aspire-orchestrator","title":".NET Aspire Orchestrator","text":"<ul> <li>Coordinates API, ingestion triggers, ML calls</li> <li>Provides unified logging, metrics, health endpoints</li> </ul>"},{"location":"03_architecture/#azure-app-service-or-azure-container-apps","title":"Azure App Service or Azure Container Apps","text":"<ul> <li>Hosts ASP.NET Core API</li> <li>Endpoints:</li> <li>Profile CRUD</li> <li>Query orchestration (retrieval \u2192 ranking \u2192 RAG)</li> <li>Feedback processing</li> <li>Adjustment / regeneration</li> </ul>"},{"location":"03_architecture/#33-data-ingestion-layer","title":"3.3 Data Ingestion Layer","text":""},{"location":"03_architecture/#azure-functions-consumption","title":"Azure Functions (Consumption)","text":"<ul> <li>Scheduled jobs: Weather, Events, Holidays, Reddit, YouTube</li> <li>Writes raw JSON to Blob Storage</li> </ul>"},{"location":"03_architecture/#logic-apps","title":"Logic Apps","text":"<ul> <li>Low-code connectors (RSS feeds, calendar sync)</li> </ul>"},{"location":"03_architecture/#azure-data-factory-bulk-batch","title":"Azure Data Factory (Bulk / Batch)","text":"<ul> <li>Future: larger partner or open data dumps (tourism boards, open GTFS, seasonal festival feeds)</li> <li>Handles schema drift detection + mapping for high-volume imports</li> </ul>"},{"location":"03_architecture/#event-grid-real-time-partner-or-system-events","title":"Event Grid (Real-Time Partner or System Events)","text":"<ul> <li>Subscription to partner push events (e.g., festival program updates, petal status changes)</li> <li>Triggers light-weight Functions to patch normalized records + invalidate caches</li> </ul>"},{"location":"03_architecture/#34-storage","title":"3.4 Storage","text":"Service Role Azure Blob Storage Raw/unstructured data (articles, transcripts) Azure SQL Database (Basic) MVP authoritative store (profiles, trips, feedback) Azure Cosmos DB (Future) Horizontal scale + multi-region latency optimizations for Petals / high-write signals Azure AI Search (Basic) Hybrid BM25 + vector + filters for Petals Azure Cache for Redis (Planned) Retrieval set cache, semantic response cache, provider raw cache"},{"location":"03_architecture/#35-ai-ml","title":"3.5 AI &amp; ML","text":"Component Purpose Azure OpenAI Embeddings + RAG generation (trip cards) Azure ML Endpoint Ranking model (LightFM/GBM) serving Azure Maps Distance, travel time, potential isochrones Azure Cognitive Services (Vision / Language) Image tagging, OCR, sentiment, summarization, translation"},{"location":"03_architecture/#36-observability-cost-control","title":"3.6 Observability &amp; Cost Control","text":"Tool Use Azure Monitor + App Insights Latency, dependency, error tracking Cost Management + Budgets Budget thresholds (70%, 90%) .NET Aspire Dashboard Unified service map &amp; logs Freshness Dashboard (Planned) Monitors last_updated vs SLA per source &amp; license flags TOS Compliance Layer Enforces license_flags (cacheable, attribution-required, retention)"},{"location":"03_architecture/#4-data-flow-mvp-vs-extended","title":"4. Data Flow (MVP vs Extended)","text":"<ol> <li>Ingestion (MVP): Functions fetch \u2192 Blob (raw) \u2192 enrich (tags, geodata) \u2192 embed (OpenAI) \u2192 index (AI Search).   Extended: Data Factory batch loads &amp; Event Grid pushes feed incremental deltas into enrichment pipeline.</li> <li>Query: UI request \u2192 API \u2192 intent classification + profile context \u2192 Redis (semantic retrieval set check) \u2192 hybrid retrieve (BM25 + vector + filters) \u2192 optional enrichment (stale/missing) \u2192 rank (heuristic / ML) \u2192 top\u2011k to OpenAI.</li> <li>Feedback: User actions \u2192 SQL (MVP) / Cosmos (future) \u2192 freshness &amp; popularity score updates \u2192 nightly ranker retrain (Azure ML) \u2192 redeploy model endpoint.</li> <li>Adjust: User refinement prompt + original context \u2192 delta retrieval scope (segment/day) \u2192 constrained generation \u2192 attribution &amp; compliance pass.</li> </ol>"},{"location":"03_architecture/#41-rag-caching-subsystem-detailed-overview","title":"4.1 RAG + Caching Subsystem (Detailed Overview)","text":"Step Description Cache Layer Notes Intent Normalization Hash canonical intent (filters + geo cluster + profile class) n/a Feed into key template Retrieval Set Check Key: <code>retrieval:intent:{hash}:v1</code> Redis (planned) Stores petal IDs + slim metadata Hybrid Retrieval AI Search: BM25 + vector + filters (geo, seasonality, accessibility, license_flags) n/a Use topK ~40 then slice Conditional Enrichment External APIs on stale/missing fields Provider cache TTL per provider TOS Context Assembly Build prompt slices (petal snippets + profile prefs) n/a Token target &lt; 6k Generation Azure OpenAI Semantic response cache Key: <code>semantic:trip_seed:{hash}:v1</code> Post-Process Attribution, license filtering, novelty tagging n/a Enforce license_flags Store Generated Save structured itinerary / suggestions Semantic response cache TTL 6\u201324h (adaptive) Delivery JSON payload to client n/a Client may persist offline subset <p>Cache Invalidation Triggers: source update (Event Grid), user edit, license flag change, season boundary, freshness threshold.</p>"},{"location":"03_architecture/#42-provider-abstraction","title":"4.2 Provider Abstraction","text":"<p>Implement a <code>PlacesProvider</code> interface to isolate partner specifics (Tripadvisor, Google Places, Bing) enabling swappable adapters and consistent enrichment + rate limit handling.</p>"},{"location":"03_architecture/#5-cost-effectiveness-strategies","title":"5. Cost-Effectiveness Strategies","text":"<ul> <li>Serverless ingestion to avoid idle compute</li> <li>Basic tiers (SQL, Search) until utilization justifies scale up</li> <li>Batch embedding jobs (avoid per-item overhead)</li> <li>Blob Storage for cheap raw retention</li> <li>Local dev training (e.g., GPU laptop) before cloud promotion</li> <li>Defer Redis until cacheable query volume &gt; threshold; use in-memory LRU fallback early</li> <li>SQL first for predictable cost, migrate hot collections (Petals, feedback signals) to Cosmos when write/partition pressure justifies</li> </ul>"},{"location":"03_architecture/#6-deployment-strategy","title":"6. Deployment Strategy","text":"Environment Purpose Key Notes Local Dev iteration Aspire + local emulators where possible Dev (Azure) Shared preview Smaller SKUs, feature validation Prod Live users Autoscale policies + budgets <p>CI/CD (GitHub Actions): lint \u2192 test (future) \u2192 build \u2192 deploy SWA + API + Functions \u2192 optional manual approval to prod.</p> <p>Infra as Code: Bicep or Terraform modules (network, data, app, ml).</p>"},{"location":"03_architecture/#7-execution-plan-phase-0-mvp","title":"7. Execution Plan (Phase 0 \u2192 MVP)","text":"<ol> <li>Provision resource group + baseline services</li> <li>Implement first three ingestion jobs (Weather, Events, Holidays)</li> <li>Define Cognitive Search index &amp; embedding field strategy</li> <li>Implement profile-based retrieval endpoint</li> <li>Integrate RAG generation + justification prompt template</li> <li>Deploy MVP to dev Azure environment</li> <li>Prototype Redis local cache emulation &amp; key patterns</li> <li>Add initial freshness telemetry (age buckets per petal)</li> </ol>"},{"location":"04_solution-design/","title":"(MVP) Solution Design","text":"<p>Authoritative implementation blueprint for the cost\u2011optimized Azure MVP. For extended / legacy architecture (Redis, Cosmos DB) see <code>architecture/README.md</code>.</p> <p>Sections: domain model, search index, ingestion, retrieval \u2192 ranking \u2192 RAG, prompts, APIs, service layout, security, cost, IaC, ML flow, observability, edge cases, implementation order, open follow\u2011ups.</p> <p>Full detailed version to be expanded (see planning conversation). Placeholder stub added to integrate navigation and clarify scope separation.</p> <p>Last updated: September 2025</p>"},{"location":"04_solution-design/#reference-architecture-linkage","title":"Reference Architecture Linkage","text":"<p>For a visual end\u2011to\u2011end mapping of ingestion \u2192 enrichment \u2192 indexing \u2192 retrieval \u2192 generation \u2192 caching \u2192 delivery, see Figure 9 in <code>feasibility-azure.md</code>. That diagram underpins the service decomposition described here (API boundary choices, cache tiers, and RAG delta refinement path). Future sections will inline component drill\u2011downs referencing the same node labels to maintain traceability from feasibility \u2192 implementation.</p>"},{"location":"04_solution-design/#domain-model-summary","title":"Domain Model (Summary)","text":"<p>Core entities and links (full specs in <code>specs/</code>):</p> Entity Key Purpose Linked Artifacts Petal Atomic recommendation unit (enriched POI/activity) Trip activities, retrieval sets Trip Container of day activities + preferences snapshot Petal references, feedback signals UserProfile Personalization + saved content + feedback Trip creation, ranking inputs <p>See: <code>specs/petal_schema.md</code>, <code>specs/trip_schema.md</code>, <code>specs/user_profile_schema.md</code>.</p>"},{"location":"04_solution-design/#search-index-field-classes","title":"Search Index Field Classes","text":"<p>Searchable: name, description, summary, tags</p> <p>Filterable: region, tags, seasonality, difficulty, accessibility, source, license_flags, status, rating, review_count, last_updated</p> <p>Sortable: rating, review_count, popularity_score, last_updated, sentiment_score</p> <p>Vector: embedding (HNSW hybrid)</p>"},{"location":"04_solution-design/#cache-key-conventions-excerpt","title":"Cache Key Conventions (Excerpt)","text":"Layer Pattern Notes Retrieval Set retrieval:intent:{hash}:v1 Intent hash includes geo + filters + profile class Trip Draft tripdraft:{trip_id}:{hash} Hash of normalized prompt context Petal Object petal:{id}:v1 Invalidate on freshness triggers Popular Region popular:petals:{region} Region rolling window ranking"},{"location":"04_solution-design/#personalization-layer-mvp","title":"Personalization Layer (MVP)","text":"<p>Inputs: UserProfile (favorite_tags, travel_modes, companions), Trip context (active day), Interaction signals (saved vs skipped vs newly discovered petals).</p> <p>Algorithm (initial):</p> <ol> <li>Build preference tag weight map (favorites + implicit from saved petals)</li> <li>Score candidate petals: base_retrieval_score * (1 + tag_boost + novelty_bonus)</li> <li>Inject 1\u20132 exploratory petals if similarity cluster tight (diversity heuristic)</li> <li>Log outcomes (selected vs ignored) for future ranking model</li> </ol> <p>Future: learned-to-rank model (Azure ML) fine-tuned quarterly.</p>"},{"location":"05_market-analysis/","title":"Market Landscape &amp; Business Analysis","text":"<p>This document summarizes current trip planning and AI itinerary tools, user pain points, BloomTrip differentiators, and strategic positioning. It informs scope, feature prioritization, and validation metrics for the weekend / short\u2011trip recommender MVP.</p>"},{"location":"05_market-analysis/#1-competitive-landscape","title":"1. Competitive Landscape","text":"Tool / Category Strengths Weaknesses / Pain Points Relevance to BloomTrip Wanderlog Group collaboration, offline itineraries, maps integration Manual research still needed; shallow personalization; limited real\u2011time feeds Demonstrates collaboration value (defer); shows gap in dynamic/weather/event adaptation TripIt Auto\u2011parses booking emails; simple itinerary consolidation Not discovery focused; email scraping privacy concerns Avoid email scraping; focus on pre\u2011booking inspiration Rome2Rio Multi\u2011modal transport, cost/time comparisons Not inspirational; static perspective Use only as future enrichment for travel time/alternatives Hopper Predictive pricing for flights/hotels No itinerary building or events; booking heavy Pricing signals out of scope MVP; keep ML cost discipline Roadtrippers Route mapping + POI along path Weak for short city/region getaways; limited personalization Confirms weekend niche underserved Tripadvisor Massive review corpus; breadth of POI Overwhelming, generic lists; ad clutter BloomTrip must curate + explain relevance Mindtrip (AI) Visual drag+drop; hidden gem surfacing Hallucinations; unreliable budget filtering Reinforces need for grounded RAG + citation policy Layla (AI) Social\u2011media trend surfacing Skews toward aesthetic / influencer bias; less family practicality Balanced, family\u2011oriented scoring is differentiator Kayak + ChatGPT Fast generic weekend ideas + booking Shallow personalization; limited context memory BloomTrip adds profile + weather + events fusion Google Gemini (AI) Access to fresh map/business data Conservative itinerary creativity; no booking Opportunities for creative plan assembly with grounding Gondola (AI) Loyalty/points optimization Niche; requires sensitive access Defer loyalty optimization phase"},{"location":"05_market-analysis/#2-crossmarket-pain-points","title":"2. Cross\u2011Market Pain Points","text":"Pain Category Description BloomTrip Response (Feature / Requirement IDs) Generic Output Cookie\u2011cutter itineraries; no family/context awareness RAG grounded personalization (FR-7..FR-12), ranking features (Solution Design \u00a74) Fragmented Sources Users juggle events, weather, holidays manually Unified ingestion (FR-4..FR-6); contextual fusion in retrieval (FR-8) Weak Short\u2011Notice Support Tools biased toward large vacations Weekend/long\u2011weekend radius logic (profile + dynamic expansion) Overload / No Curation Long unsorted POI lists Ranked + diversified top N + \u201cWhy you\u2019re seeing this\u201d (FR-10, AC-2) Limited Feedback Loop Likes/dislikes underused or absent Explicit feedback actions (FR-12, FR-13), immediate user vector update Hallucinated Content AI inventions w/o sources Strict retrieval\u2011only grounding + citation enforcement (Acceptance AC-5) Privacy Concerns Email scraping / opaque data use No inbox parsing; explicit profile fields only; AAD auth (NFR-6, Security \u00a78) Poor Weather Adaptation Static suggestions despite forecast shifts Weather windows ingestion + weather_suitability feature (Solution Design \u00a74.1)"},{"location":"05_market-analysis/#3-differentiators-defensible-axes","title":"3. Differentiators (Defensible Axes)","text":"Axis Description Proof Mechanism Context Fusion Profile + weather + events + holidays + social buzz Logged feature set &amp; rationale string per idea Explainability \u201cWhy you\u2019re seeing this\u201d on every card Mandatory card field (AC-2) Adjustment Loop Natural language prompt refines plan without restart /adjust endpoint + preserved source set Grounded Generation Zero tolerance for un-cited claims Automated citation tests + hallucination guardrails Weekend Optimization 2\u20134 day radius-aware planning + long weekend expansion Dynamic radius logic tied to calendar ingestion Privacy\u2011First No email scraping; minimal PII Transparent profile schema + Key Vault + AAD Feedback\u2011Driven Evolution Save/Boost/Mute/Skip shift ranking distribution Telemetry: relevance uplift after \u22655 feedback events"},{"location":"05_market-analysis/#4-strategic-focus-mvp","title":"4. Strategic Focus (MVP)","text":"<ol> <li>Hyper\u2011relevant, explainable suggestions (precision &gt; breadth)</li> <li>Dynamic adaptation: weather &amp; holiday aware</li> <li>Low\u2011friction adjustment (prompt refine, not rebuild)</li> <li>Grounded RAG with strict source provenance</li> <li>Weekend niche leadership before expansion (avoid premature breadth)</li> </ol> <p>Positioning Statement:</p> <p>\u201cThe only weekend trip planner that blends your profile, live events, weather, and social buzz into grounded, explainable suggestions you can tweak instantly \u2014 all without giving up your privacy.\u201d</p>"},{"location":"05_market-analysis/#5-implications-for-backlog","title":"5. Implications for Backlog","text":"Backlog Theme Rationale Priority Weather Windows Scoring Differentiator vs static tools High Source Citation Enforcement Trust &amp; anti\u2011hallucination High Feedback Vector Update Personalization loop integrity High Diversity (MMR) Avoid near duplicate suggestions Medium Adjustment Prompt Flow Keeps user in context (retention) High Event + Holiday Fusion Drives \u201cwhy now\u201d value High Drive Time Caching Cost &amp; latency control Medium Budget Guardrails Maintain &lt;$150 spend target High"},{"location":"05_market-analysis/#6-kpi-validation-framework","title":"6. KPI &amp; Validation Framework","text":"KPI Definition Target (MVP) Measurement Idea Precision % of top\u201110 user marks as \u201crelevant\u201d \u226560% Inline feedback tagging Explanation Coverage Cards with non\u2011empty rationale 100% Response schema validation Adjustment Success Rate Adjust calls returning revised card w/ distinct plan \u226590% Diff analysis (activities set) Feedback Impact Relevance lift after \u22655 actions +20% Rolling window comparison Hallucination Rate Claims lacking cited source &lt;2% Automated test harness Median Idea Latency /ideas end-to-end \u22642.5s App Insights timer Token Spend / Idea Prompt + completion tokens Tracked, trending downward OpenAI usage export"},{"location":"05_market-analysis/#7-risks-mitigations","title":"7. Risks &amp; Mitigations","text":"Risk Impact Mitigation Insufficient Event Coverage Weak \u201cwhy now\u201d value Start with 1\u20132 high-signal sources; expand later Weather Model Drift Poor suitability scoring Periodic manual validation + distribution monitoring User Feedback Sparsity Slow personalization Bootstrap with interest tags + seed embeddings Token Cost Overrun Budget breach Batch embeddings; strict top-k; monitor tokens/day Data Freshness Gaps Stale suggestions SLA tracking (index freshness metric) Over-scoped MVP Delayed launch Enforce focus checklist (Section 4)"},{"location":"05_market-analysis/#8-traceability-to-requirements","title":"8. Traceability to Requirements","text":"Requirement Group Supports Notes FR-4..FR-6 Ingestion Landscape pains: fragmentation Consolidates multi-source data FR-7..FR-10 RAG Generic output, grounding Personalized retrieval + generation FR-11..FR-12 Ranking/Feedback Feedback loop weakness Adaptive scoring FR-13..FR-14 Adjustment Low-friction iteration Keeps context intact NFR-8..NFR-9 Cost Token &amp; infra control KPIs include token spend AC-2 / AC-5 Explainability &amp; Grounding Trust &amp; differentiation Mandatory card schema fields"},{"location":"05_market-analysis/#9-source-references","title":"9. Source References","text":"<p>External observations informed by public product usage and documentation from: Wanderlog, Tripadvisor, Mindtrip, Layla, Kayak, Google Gemini, Hopper, Roadtrippers, Rome2Rio, Gondola, selected industry articles.</p> <p>No proprietary or scraped private data used.</p> <p>Last updated: September 2025</p>"},{"location":"06_market-comparison/","title":"Feature Comparison Matrix","text":"<p>Comparison of BloomTrip MVP vs selected established and AI-driven trip planning tools. Legend: \u2705 Strong, \u26a0\ufe0f Partial, \u274c Missing.</p> Feature / Capability BloomTrip (MVP) Wanderlog TripIt Roadtrippers Tripadvisor Mindtrip (AI) Weekend-first focus \u2705 Optimized 2\u20134 day + long-weekend expansion \u274c \u274c \u274c (road focus) \u274c \u274c Profile personalization \u2705 Home base + radius + interests + constraints \u26a0\ufe0f Tags only \u274c \u274c \u274c \u26a0\ufe0f Basic Real-time events integration \u2705 Festivals/concerts/exhibitions \u274c \u274c \u274c \u274c \u274c Weather-aware suggestions \u2705 Forecast-driven context \u274c \u274c \u274c \u274c \u274c Holiday / school break awareness \u2705 Radius expansion logic \u274c \u274c \u274c \u274c \u274c Social buzz (Reddit/YouTube) \u2705 Source blending \u274c \u274c \u274c \u274c \u26a0\ufe0f Trend focus Grounded RAG with citations \u2705 All sources cited \u274c \u274c \u274c \u274c \u274c Feedback loop (Save/Boost/Mute/Skip) \u2705 Ranking adaptation \u274c \u274c \u274c \u274c \u26a0\ufe0f Limited Prompt-to-adjust \u2705 Context-preserving \u274c \u274c \u274c \u274c \u26a0\ufe0f Restart needed Multi-modal content \u2705 Text + maps + media \u26a0\ufe0f Maps \u274c \u2705 Maps/photos \u2705 Photos \u26a0\ufe0f Images only Privacy-first (no email scraping) \u2705 OIDC + managed identity \u26a0\ufe0f Account only \u274c Email parsing \u274c \u274c \u274c Campervan / off-grid angle \u2705 Facilities + e-bike \u274c \u274c \u26a0\ufe0f Some \u274c \u274c Cost transparency in cards \u2705 Budget hints \u274c \u274c \u274c \u274c \u274c"},{"location":"06_market-comparison/#key-differentiators","title":"Key Differentiators","text":"<ol> <li>Weekend-trip niche ownership.</li> <li>Live profile + events + weather + holiday + social fusion.</li> <li>Grounded RAG with verifiable citations (trust factor).</li> <li>Immediate feedback &amp; adjustment loop (stickiness).</li> <li>Privacy-first posture (no inbox scraping, minimal PII).</li> <li>Campervan / off-grid contextualization (initial region value-add).</li> </ol>"},{"location":"06_market-comparison/#strategic-implications","title":"Strategic Implications","text":"Area Implication Messaging Lead with \u201cplans your weekend, not just vacations.\u201d Scope Discipline Defer booking, loyalty, complex multi-city routing. Retention Highlight adjust + feedback actions early in UX. Trust Surface citations + privacy statement prominently. Growth Expand beyond Romania only after KPI baselines stable. <p>Last updated: September 2025</p>"},{"location":"compliance/","title":"Compliance &amp; Licensing","text":"<p>This page defines how source licensing, user privacy, and retention shape caching and generation.</p>"},{"location":"compliance/#1-data-source-inventory","title":"1. Data Source Inventory","text":"Source Type License / Terms Cached? Notes Tripadvisor POI metadata API TOS Partial ( IDs + derived features ) Raw text not stored long-term. Google Places POI API TOS Minimal Consider place ID only; enrich on demand. OSM / Wikivoyage Open data ODbL / CC BY-SA Yes (with attribution) Keep attribution list. Weather API Forecast Commercial Ephemeral No long-term retention. Events API Events Varies Yes (normalized) Purge past-dated events."},{"location":"compliance/#2-license-flags-meanings","title":"2. License Flags &amp; Meanings","text":"Flag Meaning Effect <code>cache_ok</code> Content can be cached with TTL Enables Redis store <code>no_cache</code> Must not persist body Only derived embeddings allowed <code>attrib_required</code> Must display source attribution UI badge + link <code>restricted_use</code> Limited downstream usage Blocks inclusion in public exports"},{"location":"compliance/#3-cache-eligibility-matrix","title":"3. Cache Eligibility Matrix","text":"Content Type Short-term Cache Long-term Store Notes Petal metadata Yes Yes Normalized &amp; versioned External raw response No Optional (temp &lt;24h) Debug bucket only Generated itinerary Yes (user) Yes (if saved) User-owned asset Generated recommendation set Yes No Recompute if expired"},{"location":"compliance/#4-retention-purge-policy","title":"4. Retention &amp; Purge Policy","text":"<ul> <li>Event data: purge 30 days after event end.</li> <li>Raw external API payloads: auto-delete after 24h.</li> <li>Unused draft trips: purge after 14 days inactivity.</li> <li>Logs with user IDs: retain 30 days, then anonymize.</li> </ul>"},{"location":"compliance/#5-attribution-rendering-rules","title":"5. Attribution Rendering Rules","text":"<ul> <li>Collect all <code>attrib_required</code> sources per response.</li> <li>De-duplicate; order by prominence (primary POIs first).</li> <li>Append license footnote for ODbL / CC BY-SA.</li> </ul>"},{"location":"compliance/#6-user-data-privacy-considerations","title":"6. User Data &amp; Privacy Considerations","text":"<ul> <li>Minimize stored PII (avoid free-text bios in early phase).</li> <li>Hash or pseudonymize internal analytics identifiers.</li> <li>Provide delete endpoint for profile + generated trips (soft delete \u2192 7 day hard purge).</li> </ul> <p>Last updated: September 2025</p>"},{"location":"contributing/","title":"Contributing","text":"<p>This project welcomes contributions of all kinds: code, tests, documentation, design feedback, and ideas.</p> <p>The canonical contribution guidelines live in the repository root <code>CONTRIBUTING.md</code>. This page summarizes the key points:</p>"},{"location":"contributing/#contribution-workflow","title":"Contribution Workflow","text":"<ol> <li>Fork and create a feature branch: <code>feat/&lt;short-name&gt;</code> or <code>fix/&lt;short-name&gt;</code></li> <li>Keep commits small and meaningful</li> <li>Add or update tests when changing behavior</li> <li>Open a Pull Request describing problem, approach, and trade\u2011offs</li> </ol>"},{"location":"contributing/#commit-message-format-suggested","title":"Commit Message Format (Suggested)","text":"<p><code>&lt;type&gt;(optional scope): &lt;short summary&gt;</code> where type is one of: <code>feat</code>, <code>fix</code>, <code>docs</code>, <code>chore</code>, <code>refactor</code>, <code>test</code>, <code>perf</code>, <code>build</code>.</p>"},{"location":"contributing/#areas-to-help","title":"Areas to Help","text":"<ul> <li>Filling out missing diagrams or mockups</li> <li>Schema refinement &amp; validation tests</li> <li>Performance and caching instrumentation</li> <li>Improving accessibility notes in mockups</li> </ul>"},{"location":"contributing/#reporting-bugs","title":"Reporting Bugs","text":"<p>Provide: description, steps to reproduce, expected vs actual, environment details.</p>"},{"location":"contributing/#security","title":"Security","text":"<p>Please avoid posting potential security issues publicly until a private disclosure process is defined.</p>"},{"location":"contributing/#license","title":"License","text":"<p>By contributing, you agree your contributions are licensed under the repository license (MIT).</p> <p>For full details see the root <code>CONTRIBUTING.md</code> file.</p>"},{"location":"feasibility-azure/","title":"Feasibility on Azure","text":"<p>Yes \u2014 the BloomTrip product vision is fully achievable on Azure using managed services that cover retrieval, generation, geospatial intelligence, data ingestion, caching, personalization, and compliance controls.</p> <p> Figure 9. Azure feasibility architecture overview: ingestion (Functions/Logic Apps) \u2192 normalization &amp; enrichment (OpenAI/Cognitive Services) \u2192 indexing &amp; retrieval (AI Search hybrid + semantic) \u2192 generation (Azure OpenAI) \u2192 caching (Redis tiers) \u2192 delivery (SPA + APIs + Maps) with governance (Key Vault, Monitor, Entra ID).</p> <p>??? note \"Mermaid Text Fallback (Figure 9)\"     ```mermaid     flowchart LR         subgraph Sources             A1[Tripadvisor API]:::ext             A2[Google Places]:::ext             A3[Open Data (OSM/Wiki)]:::ext             A4[User Feedback / UGC]         end         subgraph Ingestion             F1[Functions Schedules]             F2[Logic Apps Workflows]         end         subgraph Enrichment             E1[Normalization Logic]             E2[OpenAI Classification]             E3[Cognitive Services (Vision/OCR)]         end         subgraph Storage             S1[(Blob Raw)]             S2[(Cosmos / PG Normalized)]             S3[(Redis Caches)]         end         subgraph Retrieval             R1[AI Search Index\\nBM25 + Vector + Filters]         end         subgraph Generation             G1[Azure OpenAI GPT]         end         subgraph Delivery             D1[API (Functions/Container Apps)]             D2[Web SPA]             D3[Navigation Deep Links]         end         subgraph Governance             K1[Key Vault]             M1[App Insights/Monitor]             I1[Entra ID]         end</p> <pre><code>    Sources --&gt; Ingestion --&gt; Enrichment --&gt; Storage --&gt; Retrieval --&gt; Generation --&gt; Delivery\n    R1 --&gt; G1\n    G1 --&gt; S3\n    S3 --&gt; D1\n    D1 --&gt; D2\n    D1 --&gt; D3\n    K1 --&gt; D1\n    I1 --&gt; D1\n    M1 --&gt; D1\n\n    classDef ext fill=#EEE,stroke=#999,color=#333;\n```\n</code></pre>"},{"location":"feasibility-azure/#1-core-azure-service-alignment","title":"1. Core Azure Service Alignment","text":"Capability Azure Service(s) Role in BloomTrip Hybrid Search (BM25 + Vector + Semantic) Azure AI Search (vector + semantic ranker) Retrieve petals, trips, guides, events for RAG and swaps Embeddings &amp; Generation Azure OpenAI (Embeddings + GPT) Create itinerary drafts, refinement deltas, summaries Geospatial Maps, Routing, Isochrones Azure Maps Tiles, routes, distance matrix, traffic, weather layers Ingestion / Orchestration Azure Functions, Logic Apps, Data Factory Scheduled pulls, ETL, enrichment pipelines Low\u2011latency Caching Azure Cache for Redis API result cache, semantic response cache, retrieval set cache Primary Data Stores Azure Cosmos DB (NoSQL) / Azure PostgreSQL Petals, trips, user library, activity feedback, normalized POI metadata Object / Raw Storage Azure Blob Storage Raw source JSON, media assets, archived prompts, embeddings backup Auth / Identity Microsoft Entra ID (B2C or external IdP) User auth, admin console, service-to-service OIDC Observability Application Insights, Log Analytics, Azure Monitor Latency, errors, cost telemetry, custom RAG metrics Secrets &amp; Keys Azure Key Vault API keys (Tripadvisor, Google Places, Maps), OpenAI keys Background Jobs Azure Container Apps Jobs / Functions timers Nightly ranking refresh, popularity model update Personalization / ML Ops (future) Azure Machine Learning Train + deploy ranking / personalization models"},{"location":"feasibility-azure/#2-thirdparty-external-provider-integration","title":"2. Third\u2011Party / External Provider Integration","text":"Provider Use Notes / TOS Considerations Tripadvisor Content API Rich POI metadata, ratings, categories Partner access; cache only permitted fields + TTL; store stable IDs Google Places / Geocoding POI lookup, details, photos metadata Store Place IDs, minimal cache; refetch on demand for restricted fields Google / Apple / Waze Navigation deep links Pure client deep link = low risk (no data retention) Azure Maps (alt to Google for routing) Tiles, routing, isochrones Single-vendor simplification; caching within terms Bing / Web Search APIs Discovery of candidate sources Treat results as pointers; crawl only licensable pages OpenStreetMap / Overpass Base open POI + trails Attribute per ODbL; retain raw + normalized forms Wikivoyage / Wikipedia / Wikidata Descriptive + structured context Respect CC BY-SA / attribution; avoid storing full articles verbatim in generated output Eventbrite / Meetup (future) Local events enrichment Rate limits; map to Petal event subtype <p>Tip: Implement a <code>PlacesProvider</code> interface (e.g. <code>getPlace(id)</code>, <code>searchPlaces(bounds, filters)</code>) so adapters for Tripadvisor, Google, Azure Maps remain swappable.</p>"},{"location":"feasibility-azure/#3-open-extensible-data-sources","title":"3. Open &amp; Extensible Data Sources","text":"<ul> <li>Tourism board feeds (events, seasonal closures)</li> <li>GTFS transit feeds for travel time context</li> <li>User-generated petals (ratings, notes, discoveries)</li> <li>Strava / Komoot / AllTrails (licensed) route metadata (future)</li> </ul> <p>Normalize everything into a unified Petal Schema (already defined elsewhere) capturing: core identity, geo, tags, seasonality, family/pet flags, source, license flags, freshness timestamp.</p>"},{"location":"feasibility-azure/#4-rag-architecture-on-azure-high-level-phases","title":"4. RAG Architecture on Azure (High-Level Phases)","text":"Phase Steps Azure Components Ingest Fetch \u2192 validate \u2192 persist raw Functions / Logic Apps \u2192 Blob Normalize Transform \u2192 classify \u2192 tag (OpenAI) Functions + OpenAI + Cosmos/PostgreSQL Index Embed \u2192 upsert vectors + filters OpenAI Embeddings + AI Search Retrieve Hybrid (vector + BM25 + filters) + semantic rank AI Search Semantic + Vector combo Generate Compose prompt (context slices + user prefs) Azure OpenAI (GPT) Delta Refine Constrained segment update prompts Azure OpenAI + minimal retrieval scope Observe Log tokens, latency, retrieval hit ratio App Insights + custom metrics <p>Safety: Always include citations (Petal IDs, sources) so generated text can be audited and reinforced.</p>"},{"location":"feasibility-azure/#5-caching-strategy-layers-cacheaugmented-generation","title":"5. Caching Strategy Layers (Cache\u2011Augmented Generation)","text":"Layer Key TTL Store Purpose Provider API provider:place:{id} Minutes\u2013Hours (per TOS) Redis Reduce external API spend Retrieval Set retrieval:intent_hash:{hash} 1\u20136h Redis Avoid requerying index for frequent intents Semantic Response semantic:trip_seed:{hash} 6\u201324h Redis Reuse stable itinerary drafts for similar prompts Delta Patch delta:segments:{tripId}:{scopeHash} 1h Redis Faster rollback / replay of refinements Popular Petals Snapshot popularity:region:{regionId} 30\u201360m Redis Low-latency surfacing on homepage / rails <p>Invalidation Triggers: petal edit, new rating, stale freshness timestamp, source update event, seasonal boundary crossing.</p>"},{"location":"feasibility-azure/#6-maps-navigation-integration","title":"6. Maps &amp; Navigation Integration","text":"<p>Rendering &amp; planning can use Azure Maps (or dual provider abstraction). Deep links remain client side:</p> Provider Deep Link Pattern Google Maps <code>https://www.google.com/maps/dir/?api=1&amp;origin=LAT1,LON1&amp;destination=LATN,LONN&amp;waypoints=LAT2,LON2\\|LAT3,LON3</code> Apple Maps <code>maps://?saddr=LAT1,LON1&amp;daddr=LATN,LONN</code> Waze <code>https://waze.com/ul?ll=LATN,LONN&amp;navigate=yes</code> <p>Waypoint Compression: prioritize origin, final destination, must-keep petals, overnights, longest duration, high scenic rating.</p>"},{"location":"feasibility-azure/#7-practical-implementation-path","title":"7. Practical Implementation Path","text":"<ol> <li>Finalize Petal schema &amp; implement normalization pipeline</li> <li>Stand up Azure AI Search index (vector + semantic) with pilot dataset</li> <li>Add OpenAI embedding + generation flow for initial itinerary creation</li> <li>Implement Redis caching scaffolding (provider, retrieval, semantic tiers)</li> <li>Build Map provider abstraction &amp; deep link navigation picker</li> <li>Instrument telemetry (token usage, retrieval latency, cache hit rate)</li> <li>Add feedback ingest (survey) \u2192 update Popular Petals ranking nightly</li> </ol>"},{"location":"feasibility-azure/#8-azure-cognitive-services-value-add","title":"8. Azure Cognitive Services Value Add","text":"Category Service BloomTrip Use Vision Computer Vision / Image Analysis Auto-tag user / partner images (lake, forest, indoor) Vision OCR (Read) Extract text from signage / menus for metadata enrichment Language Text Analytics (Sentiment) Weight POI quality; filter low-sentiment notes Language Summarization Compress long reviews into concise blurbs Language Entity Linking Connect unstructured text to canonical places / events Language Translator Localize descriptions &amp; prompts Speech Speech to Text Voice-driven trip idea capture Speech Text to Speech Audio narration of itinerary or navigation hints Decision Personalizer / Custom models Future adaptive ranking of suggestions Search Bing Autosuggest / Web / Images Discover emerging events / enrich content candidates"},{"location":"feasibility-azure/#9-rag-cognitive-services-pipeline-augmented","title":"9. RAG + Cognitive Services Pipeline (Augmented)","text":"<ol> <li>Ingest raw source \u2192 store Blob.</li> <li>Vision/OCR tagging &amp; entity linking augment raw metadata.</li> <li>Generate embeddings \u2192 upsert searchable + filter fields.</li> <li>Query: parse user intent \u2192 semantic + vector hybrid retrieval.</li> <li>Re-rank (semantic ranker + optional learned ranker) \u2192 slice top context.</li> <li>Prompt assembly (citations + constraints) \u2192 OpenAI generation.</li> <li>Post-process: citation verification, PII scrub, caching.</li> <li>Log metrics &amp; feedback loops (ratings update embeddings periodically / nightly retrain).</li> </ol>"},{"location":"feasibility-azure/#10-governance-compliance-considerations","title":"10. Governance &amp; Compliance Considerations","text":"Aspect Control Provider TOS Metadata field-level flags (cacheable, ttl, rehydrate) PII Basic regex + Cognitive Services detection pipeline before storage Attribution Automatic footer injection for OSM / Wikivoyage derived content Data Residency Select Azure region matching majority user base; replicate read-only search to secondary region Cost Guardrails Daily budgets: OpenAI tokens, Search queries, Redis memory; alerts via Monitor Security Key Vault rotation + managed identities for Functions / Container Apps"},{"location":"feasibility-azure/#11-suggested-reference-architecture-conceptual-layers","title":"11. Suggested Reference Architecture (Conceptual Layers)","text":"Layer Components Notes Edge / Client Web SPA (React), Mobile shell (future) Uses provider deep links for navigation API / Orchestration Azure Functions + Minimal API / Container Apps Auth via Entra ID; throttling + caching Data &amp; Content Cosmos DB, PostgreSQL, Blob Storage Separation of raw vs normalized content Intelligence Azure AI Search, Azure OpenAI, Cognitive Services RAG + enrichment + classification Caching Redis (tiered namespaces) Key tagging for targeted invalidation Analytics &amp; Ops App Insights, Log Analytics, Monitor, Cost Mgmt Unified dashboard (latency, cost, freshness) Security &amp; Compliance Key Vault, Entra ID, Defender for Cloud Least privilege RBAC, secret isolation"},{"location":"feasibility-azure/#12-future-enhancements","title":"12. Future Enhancements","text":"<ul> <li>Personalized ranking model (Azure ML) trained on feedback &amp; usage.</li> <li>On-device vector pruning (mobile offline mode) for cached recent petals.</li> <li>Multi-lingual itinerary generation with dynamic translation fallback.</li> <li>Route optimization with constraints (EV charging, daylight windows).</li> <li>Real-time event injection (webhooks) into active itineraries.</li> </ul>"},{"location":"feasibility-azure/#13-cross-links","title":"13. Cross-Links","text":"<p><code>04_solution-design.md</code> \u2022 <code>rag_pipeline.md</code> \u2022 <code>architecture/azure_overview.md</code> \u2022 <code>mockups/trip-feedback-survey.md</code></p> <p>Last updated: 2025-09-05</p>"},{"location":"getting_started/","title":"Getting Started","text":"<p>This guide orients new contributors and sets up a local docs preview.</p>"},{"location":"getting_started/#1-prerequisites","title":"1. Prerequisites","text":"<ul> <li>Python 3.11+ (for MkDocs Material build)</li> <li>Node (future frontend services \u2013 optional now)</li> <li>Git</li> </ul>"},{"location":"getting_started/#2-clone-install-docs-dependencies","title":"2. Clone &amp; Install Docs Dependencies","text":"<p>Create a virtual environment and install mkdocs-material when ready:</p> <pre><code>python -m venv .venv\n./.venv/Scripts/Activate.ps1\npip install mkdocs-material\n</code></pre>"},{"location":"getting_started/#3-serve-documentation-locally","title":"3. Serve Documentation Locally","text":"<pre><code>mkdocs serve\n</code></pre> <p>Navigate to http://127.0.0.1:8000</p>"},{"location":"getting_started/#4-directory-layout-current-focus","title":"4. Directory Layout (Current Focus)","text":"Path Purpose <code>docs/architecture/</code> System &amp; cloud architecture docs <code>docs/specs/</code> Domain &amp; API specifications <code>docs/operations/</code> Monitoring / deployment playbooks <code>schemas/</code> JSON Schema contracts <code>services/</code> (Future) Service implementation folders"},{"location":"getting_started/#5-validating-schemas-planned","title":"5. Validating Schemas (Planned)","text":"<p>Add a Python script or Node task to validate JSON instances against <code>schemas/*.json</code> (tooling TBD).</p>"},{"location":"getting_started/#6-contributing-flow-draft","title":"6. Contributing Flow (Draft)","text":"<ol> <li>Branch from <code>main</code> (<code>feat/</code>, <code>fix/</code> prefix)</li> <li>Update or add docs alongside code changes</li> <li>Open PR; include rationale &amp; any trade-offs</li> <li>After merge, Read the Docs auto-build (future CI)</li> </ol>"},{"location":"getting_started/#7-next-additions","title":"7. Next Additions","text":"<ul> <li>Define lint tooling for schemas &amp; markdown</li> <li>Add retrieval + cache POC service modules</li> <li>Introduce test harness (pytest or similar)</li> </ul> <p>Last updated: September 2025</p>"},{"location":"one-pager/","title":"BloomTrip One-Pager","text":"<p>Tagline: Where your weekends come alive.</p> <p></p>"},{"location":"one-pager/#problem","title":"Problem","text":"<p>Planning short (2\u20134 day) getaways is time-consuming. People juggle weather forecasts, event calendars, blogs, Reddit threads, and outdated listicles\u2014still ending up with generic, mistimed, or impractical suggestions.</p>"},{"location":"one-pager/#solution","title":"Solution","text":"<p>BloomTrip is a weekend-first travel app that delivers personalized trip suggestions based on your profile, live weather, seasonal &amp; local events, and social buzz. A grounded RAG pipeline produces explainable, source\u2011cited trip cards so users know why each idea fits them right now.</p>"},{"location":"one-pager/#market-opportunity","title":"Market Opportunity","text":"<ul> <li>Weekend travel: $100B+ global segment inside a $927B leisure travel market (indicative figures; cite in future revision)</li> <li>Remote &amp; hybrid work increases spontaneous short-trip frequency</li> <li>Romania &amp; Eastern Europe remain underserved by context-aware weekend planners</li> <li>Rising interest in campervan / e\u2011bike / nature micro-adventures</li> </ul>"},{"location":"one-pager/#why-now","title":"Why Now","text":"<ol> <li>Advances in personalization + retrieval augmented generation (RAG)</li> <li>Mature real-time APIs (weather, events, social) reduce integration friction</li> <li>Shift toward flexible schedules &amp; micro-travel post-pandemic</li> <li>Privacy-first cloud patterns (OIDC, managed identities) enable trust differentiation</li> </ol>"},{"location":"one-pager/#key-features","title":"Key Features","text":"Pillar Feature User Benefit Curated Experiences Hidden gem surfacing Discover non-generic, profile-aligned ideas Timely Suggestions Weather + seasonal alignment Avoids rained\u2011out or off\u2011season picks Tailored Itineraries Ready-to-go trip cards Reduces planning hours to minutes Feedback Loop Save / Boost / Mute / Skip + adjust System learns taste quickly Grounded AI Source citations (Reddit, YouTube, events) Trust &amp; transparency Off\u2011Grid Support Campervan / e\u2011bike tags Niche depth early moat"},{"location":"one-pager/#mvp-preview","title":"MVP Preview","text":"<p>Profile Setup: Home base, travel radius, interests, constraints. Trip Feed: 2\u20134 day suggestions with \u201cWhy now\u201d + \u201cFit for you\u201d rationale. Feedback Actions: Save / Boost / Mute / Skip; immediate personalization updates. Prompt-to-Adjust: Natural language refinement (\u201cMore family friendly\u201d, \u201cRainy-day options\u201d). Campervan Readiness: Surface stays &amp; stops aligned with off\u2011grid patterns.</p>"},{"location":"one-pager/#differentiation-snapshot","title":"Differentiation Snapshot","text":"<ul> <li>Weekend-focused scope (vs. long-vacation bias of incumbents)</li> <li>Live multi-signal fusion (events + weather + holidays + social + seasonality)</li> <li>Grounded RAG with enforced citations</li> <li>Fast adaptive loop (adjust + feedback in one surface)</li> <li>Privacy-first (no inbox scraping; managed identities)</li> <li>Early specialization in campervan / outdoor micro-adventures</li> </ul>"},{"location":"one-pager/#go-to-market-phase-01-focus","title":"Go-To-Market (Phase 0\u20131 Focus)","text":"<ol> <li>Launch landing at BloomTripApp.com for alpha waitlist &amp; messaging validation.</li> <li>Seeding: Reddit travel/outdoors communities (value posts, not promo spam).</li> <li>Partnerships: Local tourism boards &amp; campervan rental communities (Romania first).</li> <li>Content Flywheel: Auto-tagged trip cards become SEO seed pages (later phase).</li> </ol>"},{"location":"one-pager/#early-kpis-mvp","title":"Early KPIs (MVP)","text":"Metric Target Rationale Waitlist signups 1,000 pre-beta Validate positioning resonance Idea engagement (Save/Boost rate) &gt;30% Measures relevance of top-10 results Median response latency &lt;2.5s Retention &amp; perceived intelligence Citation coverage 100% of generated cards Trust &amp; differentiation Hallucination complaints / 100 sessions &lt;2 Quality guardrail"},{"location":"one-pager/#tech-stack-mvp","title":"Tech Stack (MVP)","text":"<p>Azure-native: .NET Aspire, Azure Functions (ingestion), Azure SQL, Blob Storage, Azure Cognitive Search (hybrid vector + semantic), Azure OpenAI (RAG + refinement), Azure Maps, Azure ML (ranking endpoint). Budget objective: &lt; $150/month until scale inflection.</p>"},{"location":"one-pager/#status","title":"Status","text":"<p>Alpha data ingestion &amp; retrieval in progress. Landing live for early email capture. Feedback loop + adaptive ranker targeted for Phase 2.</p>"},{"location":"one-pager/#call-to-action","title":"Call to Action","text":"<p>Join the alpha waitlist at BloomTripApp.com and get early personalized weekend ideas.</p> <p>Last updated: 2025-09-05 (one-pager.png added)</p>"},{"location":"positioning-and-messaging/","title":"Positioning &amp; Messaging","text":""},{"location":"positioning-and-messaging/#1-positioning-statement","title":"1. Positioning Statement","text":"<p>\u201cFinally, a trip planner that knows your weekends, your weather, and your world.\u201d</p> <p>We blend user profile + live events + weather + holidays + social buzz to produce grounded, explainable weekend trip ideas that adapt instantly\u2014without scraping private email or leaking data.</p>"},{"location":"positioning-and-messaging/#2-core-value-propositions","title":"2. Core Value Propositions","text":"Segment Value Proof Mechanism Families Timely, teen-friendly, low planning overhead Profile constraints + rationale field Adventurers Off\u2011grid / e\u2011bike ready, weather\u2011adaptive Weather windows + tag enrichment Planners Explainable + adjustable Rationale + prompt-to-adjust + feedback loop"},{"location":"positioning-and-messaging/#3-differentiators","title":"3. Differentiators","text":"<ol> <li>Weekend-first scope (2\u20134 day radius aware)</li> <li>Live context fusion (events + weather + holidays + social)</li> <li>Grounded RAG (citations mandatory)</li> <li>Dynamic feedback &amp; prompt adjustment loop</li> <li>Privacy-first (OIDC, no inbox parsing, managed identities)</li> <li>Campervan / off\u2011grid enrichment (initial regional moat)</li> </ol>"},{"location":"positioning-and-messaging/#4-messaging-pillars","title":"4. Messaging Pillars","text":"Pillar Tagline Support Personalized &amp; Context-Aware \"Your weekends, your way.\" Profile + blended signals Grounded &amp; Transparent \"No guesswork, just great trips.\" Citations + rationale Flexible &amp; Adaptive \"Plans that flex with you.\" Weather &amp; holiday aware + adjust endpoint"},{"location":"positioning-and-messaging/#5-elevator-pitch","title":"5. Elevator Pitch","text":"<p>\u201cWe help busy people turn free weekends into unforgettable trips\u2014by blending personal profile with live events, weather, and social buzz. The AI explains, adapts, and cites its sources so you can trust and refine every idea.\u201d</p>"},{"location":"positioning-and-messaging/#6-cta-examples","title":"6. CTA Examples","text":"<ul> <li>Plan your next weekend in 60 seconds</li> <li>See what\u2019s happening near you</li> <li>Your perfect trip is already out there\u2014let\u2019s surface it</li> <li>Join the alpha at BloomTripApp.com</li> <li>Get early access updates (email capture on homepage)</li> </ul>"},{"location":"positioning-and-messaging/#7-visual-tone-guidelines","title":"7. Visual &amp; Tone Guidelines","text":"<p>Visuals: real photos, maps, event posters, weather icons. Tone: friendly, informed, concise. Avoid hype and vague claims.</p>"},{"location":"positioning-and-messaging/#8-future-messaging-ideas","title":"8. Future Messaging Ideas","text":"<p>\"From Friday night to Monday morning.\" | \"Your weekend, upgraded.\" | \"The planner that changes with the weather.\"</p> <p>Last updated: September 2025 (updated with domain CTAs)</p>"},{"location":"rag_pipeline/","title":"RAG Pipeline Details","text":"<p>This page decomposes the RAG flow into concrete stages with responsibilities, data contracts, metrics, and failure considerations.</p> <p>Summary: User intent + profile + (optional) trip context \u2192 cache lookup \u2192 hybrid retrieval \u2192 (conditional) external enrichment \u2192 context assembly \u2192 LLM generation \u2192 attribution + compliance \u2192 cache store \u2192 client delivery.</p> <p>See domain schemas: <code>specs/petal_schema.md</code>, <code>specs/trip_schema.md</code>, <code>specs/user_profile_schema.md</code> for field definitions referenced below.</p>"},{"location":"rag_pipeline/#0-visual-flow-rag-caching-overview","title":"0. Visual Flow (RAG + Caching Overview)","text":"<pre><code>flowchart LR\n    subgraph Client\n        Q[User Query / Action]\\n(search, saved petal, promo)\n    end\n\n    subgraph API Layer\n        INT[Intention Normalization]\\n(intent_type, filters, geo cluster)\n        CK{Retrieval Set Cache Hit?}\n        RETR[Hybrid Retrieval\\nAI Search BM25 + Vector + Filters]\n        ENR{Needs Enrichment?}\\n(stale / missing fields)\n        ENR_CALL[External Provider Calls]\\n(Tripadvisor / Google / Bing)\n        CTX[Context Assembly]\\n(petals + profile + trip)\n        GEN[Azure OpenAI Generation]\\n(itinerary / refinement)\n        POST[Post-Process\\nAttribution + License Filtering]\n        STORE[Cache Store\\n(retrieval set + semantic answer)]\n    end\n\n    subgraph Caches\n        C_RETR[(Redis: retrieval:intent:{hash})]\n        C_PROV[(Redis: provider:place:{src}:{id})]\n        C_SEM[(Redis: semantic:trip_seed:{hash})]\n        C_DELTA[(Redis: delta:{tripId}:{scopeHash})]\n    end\n\n    subgraph Data\n        DB[(SQL / Future Cosmos: Petals, Trips, Profiles)]\n        RAW[(Blob: Raw Payloads &amp; Media)]\n        IDX[(AI Search Index)]\n    end\n\n    Q --&gt; INT --&gt; CK\n    CK --&gt;|hit| C_RETR --&gt; CTX\n    CK --&gt;|miss| RETR --&gt; ENR\n    ENR --&gt;|yes| ENR_CALL --&gt; C_PROV --&gt; RETR\n    ENR --&gt;|no| CTX\n    RETR --&gt; IDX\n    ENR_CALL --&gt; RAW\n    ENR_CALL --&gt; DB\n    CTX --&gt; GEN --&gt; POST --&gt; STORE\n    STORE --&gt; C_SEM\n    STORE --&gt; C_RETR\n    GEN --&gt; C_DELTA\n    RETR --&gt; C_RETR\n    DB --&gt; RETR\n    RAW --&gt; IDX\n    POST --&gt; DB\n\n    classDef cache fill=#fdf6e3,stroke=#d2b48c,color=#654321;\n    class C_RETR,C_PROV,C_SEM,C_DELTA cache;\n</code></pre> <p>Legend</p> Symbol Meaning Rounded Rectangle Processing step Diamond Decision / conditional branch ( ) Persistent store / cache Dashed grouping Logical subsystem <p>Key invalidation triggers: provider delta events, license flag changes, freshness thresholds, user edits, seasonal boundary transitions.</p>"},{"location":"rag_pipeline/#1-query-normalization","title":"1. Query Normalization","text":"<p>Normalize raw user input (text, structured filters, saved petal clicks) into an <code>IntentRequest</code> object.</p> Field Description <code>raw_text</code> Original user string (may be empty for UI-triggered actions) <code>profile_id</code> Reference to UserProfile <code>trip_id?</code> Optional active trip context <code>filters</code> Canonical filter map (geo, tags, date range, budget) <code>channel</code> web, mobile, system_recommendation <p>Failure Modes:</p> <ul> <li>Empty input (UI accidental submit) \u2192 return validation error early.</li> <li>Unsupported locale \u2192 fallback to default language pipeline.</li> </ul>"},{"location":"rag_pipeline/#2-intent-classification","title":"2. Intent Classification","text":"<p>Lightweight classifier (rule + embedding similarity initial) extracts desired artifact: discovery, refine_trip_day, enrich_petal.</p> <p>Outputs:</p> <ul> <li><code>intent_type</code> (enum)</li> <li><code>entities</code> (locations, temporal cues, activity categories)</li> </ul> <p>Metrics:</p> <ul> <li>Precision/recall on labeled sample set.</li> <li>Avg classification latency (&lt; 25 ms target).</li> </ul>"},{"location":"rag_pipeline/#3-cache-key-strategy","title":"3. Cache Key Strategy","text":"<p>Key template:</p> <pre><code>intent:{intent_type}:p:{profile_hash}:t:{trip_hash|none}:f:{filters_hash}:v1\n</code></pre> <p>Where each hash = stable 64-bit fnv or murmur of canonical JSON subset. Version suffix bumps when prompt/template semantics change.</p> <p>Cache Entries:</p> <ul> <li>Retrieval set (petal IDs + metadata snapshot)</li> <li>Generated answer (trip draft or petal recommendation set)</li> </ul> <p>Eviction &amp; TTL:</p> <ul> <li>Retrieval: 30\u2013120 min (seasonal / event-sensitive shorter)</li> <li>Generation: 10\u201330 min unless saved / bookmarked</li> </ul>"},{"location":"rag_pipeline/#4-retrieval-strategy","title":"4. Retrieval Strategy","text":"<p>Primary: Azure Cognitive Search hybrid (BM25 + vector). Filters applied server-side for geo radius, tags, seasonality, accessibility.</p> <p>Diversification: if top 8 results share &gt;60% identical tag set, replace lowest 2 with high-distance related_petals to improve itinerary variety.</p> <p>Ranking Blend (initial heuristic):</p> <pre><code>score = 0.55 * vector_score + 0.35 * bm25 + 0.10 * recency_decay\n</code></pre> <p>Future: train learned-to-rank with interaction feedback.</p> <p>Failure Modes:</p> <ul> <li>Empty result \u2192 fallback broaden filters (widen geo, relax tag strictness) once.</li> <li>API timeout \u2192 degrade to last known cached retrieval if &lt; 1h old.</li> </ul>"},{"location":"rag_pipeline/#5-external-enrichment-decision-matrix","title":"5. External Enrichment Decision Matrix","text":"<p>Trigger enrichment only if:</p> <ul> <li>Missing critical fields (e.g., opening_hours, pricing_tier)</li> <li>Stale <code>last_updated</code> &gt; threshold (e.g., 7 days for events, 30 for attractions)</li> <li>License flag requires refreshed attribution.</li> </ul> <p>Rate control: token bucket per provider; circuit breaker on consecutive failures.</p>"},{"location":"rag_pipeline/#6-context-assembly-templates","title":"6. Context Assembly Templates","text":"<p>Context blocks:</p> <ol> <li>User preferences summary (derived vector tags \u2192 natural language bullet list)</li> <li>Trip scaffold (dates, companions, known constraints)</li> <li>Petal snippets (top N, grouped by thematic cluster)</li> <li>Preference summary (favorite tags, companions, travel modes)</li> <li>Safety / license directives (DO / DO NOT usage rules)</li> </ol> <p>Size Budget:</p> <ul> <li>Target &lt; 6k tokens pre-generation (reserve headroom for model completion).</li> </ul>"},{"location":"rag_pipeline/#7-prompt-strategy-safety-filters","title":"7. Prompt Strategy &amp; Safety Filters","text":"<p>Prompt sections:</p> <ul> <li>System: role + compliance constraints</li> <li>Context: assembled blocks</li> <li>Instruction: requested output format (JSON itinerary or bullet recommendations)</li> </ul> <p>Safety:</p> <ul> <li>Regex + simple policy filter post-generation for disallowed content.</li> <li>Enforce mandatory attribution fields before returning.</li> </ul>"},{"location":"rag_pipeline/#8-response-post-processing-attribution","title":"8. Response Post-Processing &amp; Attribution","text":"<p>Steps:</p> <ol> <li>Parse JSON candidate (retry with repair prompt if invalid)</li> <li>Attach source &amp; license metadata per petal</li> <li>Insert disclaimers for AI-generated components</li> <li>Compute quality score (coverage, diversity, personalization alignment)</li> </ol>"},{"location":"rag_pipeline/#9-metrics-observability","title":"9. Metrics &amp; Observability","text":"Metric Target (MVP) Notes P95 end-to-end latency &lt; 1200 ms Assuming warm cache path ~500\u2013700 ms Cache hit ratio (retrieval) &gt; 55% Drives cost efficiency Generation token cost / req &lt; $0.25 Track by intent type Invalid JSON rate &lt; 3% Above triggers prompt revision Enrichment call success &gt; 98% After retries Diversification applied rate 10\u201325% Healthy exploratory injection <p>Traces: correlate <code>intent_id</code> across classification \u2192 retrieval \u2192 generation.</p>"},{"location":"rag_pipeline/#10-future-optimizations","title":"10. Future Optimizations","text":"<ul> <li>Learned re-ranking model using interaction feedback</li> <li>Multi-vector field indexing (separate embeddings per facet)</li> <li>Adaptive cache TTL based on volatility score</li> <li>Structured function calling for itinerary JSON validation</li> <li>Distillation of large model outputs into cheaper re-ranker</li> <li>Preference embedding refresh job (daily) feeding semantic rerank layer</li> </ul> <p>Last updated: September 2025</p>"},{"location":"roadmap/","title":"Product Roadmap","text":"<p>This roadmap connects our market positioning to a phased delivery plan. Each phase builds on our unique differentiators: weekend-first focus, live context blending, grounded AI, dynamic adaptability, privacy-first design, and campervan/off-grid readiness.</p>"},{"location":"roadmap/#phase-0-foundation-infrastructure-month-01","title":"Phase 0 \u2014 Foundation &amp; Infrastructure (Month 0\u20131)","text":"<p>Goal: Establish secure, cost-effective Azure environment and baseline services.</p> <p>Key Deliverables:</p> <ul> <li>Azure Resource Manager + Bicep modules for all core services</li> <li>EV2 deployment pipeline with environment separation (dev/test/prod)</li> <li>OIDC integration with Microsoft Entra ID for secure, secretless CI/CD</li> <li>.NET Aspire solution scaffold (frontend, backend, ingestion services)</li> <li>Azure SQL, Blob Storage, Cognitive Search (Basic), Azure Maps, Azure OpenAI provisioned</li> <li>Application Insights + budget alerts configured</li> </ul> <p>Market Tie-In: Sets the stage for privacy-first, scalable delivery \u2014 a trust differentiator.</p>"},{"location":"roadmap/#phase-1-mvp-retrieval-rag-month-23","title":"Phase 1 \u2014 MVP Retrieval &amp; RAG (Month 2\u20133)","text":"<p>Goal: Deliver the first usable version for internal testing.</p> <p>Key Deliverables:</p> <ul> <li>User profile creation (home base, radius, interests, constraints)</li> <li>Ingestion for:<ul> <li>Romanian public holidays</li> <li>Weather forecasts</li> <li>One events API</li> <li>One Reddit source</li> </ul> </li> <li>Content normalization, tagging, geocoding</li> <li>Embedding + indexing in Azure Cognitive Search</li> <li>Basic retrieval (filters + vector search)</li> <li>RAG trip card generation with citations</li> <li>React frontend: profile wizard + ideas feed</li> </ul> <p>Market Tie-In: Launches the weekend-first, context-aware core that competitors lack.</p>"},{"location":"roadmap/#phase-2-personalization-feedback-loop-month-45","title":"Phase 2 \u2014 Personalization &amp; Feedback Loop (Month 4\u20135)","text":"<p>Goal: Make recommendations adaptive and user-specific.</p> <p>Key Deliverables:</p> <ul> <li>Feedback actions: Save / Boost / Mute / Skip</li> <li>User embedding updates from feedback</li> <li>ML ranker (LightGBM or LightFM) trained locally, deployed to Azure ML endpoint</li> <li>Prompt-to-adjust flow in frontend</li> <li>Expanded ingestion: YouTube playlists + transcripts</li> <li>Weather-aware suggestion filtering</li> </ul> <p>Market Tie-In: Delivers dynamic adaptability and feedback-driven evolution \u2014 a rare combo in the market.</p>"},{"location":"roadmap/#phase-3-multi-modal-social-buzz-month-67","title":"Phase 3 \u2014 Multi-Modal &amp; Social Buzz (Month 6\u20137)","text":"<p>Goal: Enrich content and broaden discovery sources.</p> <p>Key Deliverables:</p> <ul> <li>Additional event APIs (local tourism boards, Eventbrite)</li> <li>More Reddit communities</li> <li>YouTube thumbnail + media embedding in trip cards</li> <li>Social buzz scoring (Reddit upvotes, YouTube views)</li> <li>Indoor/outdoor classification for weather adaptation</li> <li>Campervan/off-grid spot integration</li> </ul> <p>Market Tie-In: Strengthens multi-modal content and off-grid readiness \u2014 unique differentiators.</p>"},{"location":"roadmap/#phase-4-long-weekend-expansion-advanced-ranking-month-89","title":"Phase 4 \u2014 Long-Weekend Expansion &amp; Advanced Ranking (Month 8\u20139)","text":"<p>Goal: Handle extended trips and refine ranking.</p> <p>Key Deliverables:</p> <ul> <li>Calendar-aware radius expansion for long weekends</li> <li>Diversification algorithm (MMR) to avoid near-duplicates</li> <li>Popularity + novelty balancing in ranker</li> <li>Seasonal priors in cold-start recommendations</li> <li>Itinerary builder (multi-day plan from saved trips)</li> </ul> <p>Market Tie-In: Owns the long-weekend niche and improves suggestion quality.</p>"},{"location":"roadmap/#phase-5-public-beta-growth-month-1012","title":"Phase 5 \u2014 Public Beta &amp; Growth (Month 10\u201312)","text":"<p>Goal: Open to public testers, gather feedback, and prepare for scale.</p> <p>Key Deliverables:</p> <ul> <li>Public beta launch</li> <li>Usage analytics dashboard</li> <li>Performance tuning for &lt;2.5s median response</li> <li>Marketing site with positioning &amp; messaging</li> <li>Early partnerships with tourism boards or campervan communities</li> </ul> <p>Market Tie-In: Positions the product as the go-to weekend trip planner in Romania, ready to expand.</p>"},{"location":"roadmap/#future-opportunities-post-year-1","title":"Future Opportunities (Post-Year 1)","text":"<ul> <li>Multi-language support (EN/RO/DE)</li> <li>Mobile app (React Native or MAUI)</li> <li>Booking platform integrations</li> <li>Loyalty program tie-ins</li> <li>AI itinerary co-pilot chat mode</li> </ul>"},{"location":"roadmap/#roadmap-principles","title":"Roadmap Principles","text":"<ul> <li>Market-driven: Every feature ties to a differentiator.</li> <li>Privacy-first: No features that compromise user trust.</li> <li>Cost-conscious: Stay within $150/month Azure budget until scale demands more.</li> <li>Iterative: Ship small, learn fast, adapt.</li> </ul> <p>Last updated: 2025-09-05</p>"},{"location":"architecture/","title":"BloomTrip RAG + Caching + Storage Architecture (Legacy Extended View)","text":"<p>This document explains the Retrieval\u2011Augmented Generation (RAG) subsystem for BloomTrip, including caching, external API enrichment, and Azure storage mapping. It is the reference for both system flow and data contracts.</p> <p>NOTE: Current MVP replaces Cosmos DB with Azure SQL and defers Redis caching until volume justifies. See <code>../03_architecture.md</code> and <code>../04_solution-design.md</code> for authoritative MVP scope.</p>"},{"location":"architecture/#1-overview","title":"1. Overview","text":"<p>BloomTrip uses a RAG pipeline to:</p> <ul> <li>Retrieve relevant Petal objects from Azure Cognitive Search</li> <li>Optionally enrich them with external APIs (Tripadvisor, Google Places, Bing Search, open data)</li> <li>Assemble context with UserProfile and Trip data</li> <li>Generate grounded itineraries and recommendations with Azure OpenAI</li> <li>Cache results for low\u2011latency reuse, respecting provider Terms of Service (TOS)</li> </ul>"},{"location":"architecture/#2-highlevel-flow","title":"2. High\u2011Level Flow","text":"<ol> <li>User Query / Trigger</li> <li>Entry points: search bar, saved petal, promo, recommendation</li> <li>Data: <code>UserProfile</code>, optional <code>Trip</code> context</li> <li> <p>Storage: Cosmos DB (profiles, trips), Blob Storage (images)</p> </li> <li> <p>Intent Detection</p> </li> <li>Extracts filters (location, tags, seasonality)</li> <li> <p>Transient \u2014 no storage</p> </li> <li> <p>Cache Check (Azure Cache for Redis)</p> </li> <li>Key: semantic hash of <code>(intent + filters + geo cluster)</code></li> <li>Stores: retrieval sets (<code>Petal.id</code> + metadata), generated answers (<code>Trip</code> + <code>Petal</code> refs)</li> <li> <p>TTL: per provider TOS</p> </li> <li> <p>Retrieval (Azure AI Search)</p> </li> <li>Hybrid BM25 + vector search on <code>Petal</code> index</li> <li>Filters: geo radius, tags, seasonality, accessibility, license_flags</li> <li> <p>Storage: AI Search index (Petals), Cosmos DB (source of truth), Blob Storage (raw payloads, images)</p> </li> <li> <p>Conditional External API Enrichment</p> </li> <li>Sources: Tripadvisor API, Google Places API, Bing Search, OSM/Wikivoyage</li> <li>Output: normalized <code>Petal</code> objects with <code>source_id</code>, <code>license_flags</code>, <code>last_updated</code></li> <li> <p>Storage: Blob Storage (raw API responses), Cosmos DB (normalized petals)</p> </li> <li> <p>RAG Assembly &amp; Compliance Gate</p> </li> <li>Combines: retrieved/enriched <code>Petal</code> + <code>UserProfile</code> + <code>Trip</code> context</li> <li> <p>Transient \u2014 unless user saves draft trip (Cosmos DB)</p> </li> <li> <p>Generation (Azure OpenAI)</p> </li> <li>Produces: <code>Trip</code> itineraries, <code>Petal</code> recommendations</li> <li>Post\u2011process: attach attribution, enforce license_flags</li> <li> <p>Storage: Cosmos DB (itineraries), Blob Storage (generated summaries/images if allowed)</p> </li> <li> <p>Cache Store (Azure Cache for Redis)</p> </li> <li> <p>Saves retrieval sets and generated answers with TTL and tags for invalidation</p> </li> <li> <p>Client App Delivery</p> </li> <li>Sends structured JSON: <code>Trip</code> + <code>Petal</code> objects + attribution metadata</li> <li>Offline mode: local device storage, sync to Cosmos DB</li> </ol>"},{"location":"architecture/#3-data-models","title":"3. Data Models","text":""},{"location":"architecture/#petal","title":"Petal","text":"<ul> <li>Core fields: <code>id</code>, <code>name</code>, <code>description</code>, <code>location</code>, <code>tags</code>, <code>seasonality</code>, <code>source</code>, <code>source_id</code>, <code>license_flags</code>, <code>embedding</code></li> <li>Storage: Cosmos DB (normalized), Blob Storage (images), AI Search (indexed)</li> </ul>"},{"location":"architecture/#trip","title":"Trip","text":"<ul> <li>Core fields: <code>trip_id</code>, <code>title</code>, <code>dates</code>, <code>days[].activities[].petal_id</code>, <code>companions</code>, <code>tags</code>, <code>status</code></li> <li>Storage: Cosmos DB (itineraries), Blob Storage (cover images)</li> </ul>"},{"location":"architecture/#userprofile","title":"UserProfile","text":"<ul> <li>Core fields: <code>user_id</code>, <code>name</code>, <code>language</code>, <code>location</code>, <code>saved_petals[]</code>, <code>saved_trips[]</code>, <code>preferences</code></li> <li>Storage: Cosmos DB (profiles), Blob Storage (avatars)</li> </ul>"},{"location":"architecture/#4-tos-compliance-guardrails","title":"4. TOS &amp; Compliance Guardrails","text":"<ul> <li>license_flags determine:</li> <li>Cache eligibility</li> <li>Attribution requirements</li> <li>Retention period</li> <li>Enforced at:</li> <li>External API Enrichment stage</li> <li>RAG Assembly stage</li> <li>Cache invalidation:</li> <li>Time\u2011based TTL</li> <li>Event\u2011based (source update, user edit)</li> <li>Seasonal (e.g., festival date passed)</li> </ul>"},{"location":"architecture/#5-azure-components","title":"5. Azure Components","text":"Stage Azure Service(s) Cache Check / Store Azure Cache for Redis Retrieval Azure AI Search External API Enrichment Azure Functions / Logic Apps Data Storage Cosmos DB, Blob Storage Generation Azure OpenAI Monitoring Azure Monitor, Application Insights"},{"location":"architecture/#6-developer-notes","title":"6. Developer Notes","text":"<ul> <li>Schemas: See <code>/schemas/petal.schema.json</code>, <code>/schemas/trip.schema.json</code>, <code>/schemas/user_profile.schema.json</code></li> <li>Services: Retrieval logic in <code>/services/retrieval/</code>, cache logic in <code>/services/cache/</code>, enrichment connectors in <code>/services/enrichment/</code>, RAG assembly in <code>/services/rag/</code></li> <li>Config: Connection strings, TTL rules, and compliance mappings in <code>/config/</code></li> <li>Tests: Cache hit/miss, retrieval filters, TOS enforcement, schema validation in <code>/tests/</code></li> </ul>"},{"location":"architecture/#7-extended-rag-caching-flow-detailed","title":"7. Extended RAG + Caching Flow (Detailed)","text":"Step Action Cache Layer Key Pattern / Notes Intent Hash Normalize &amp; hash intent (filters + geo + profile class) n/a FNV/Murmur 64-bit Retrieval Set Lookup Check existing petal ID list Retrieval cache <code>retrieval:intent:{hash}:v1</code> Hybrid Query BM25 + vector + filters (geo, seasonality, accessibility, license_flags) n/a topK raw slice then re-rank Enrichment (if stale) Tripadvisor/Google/Bing fetch Provider cache <code>provider:place:{source}:{id}</code> Context Build Assemble snippets + profile + trip deltas n/a Token budget guard Generation OpenAI (itinerary/refine) Semantic cache <code>semantic:trip_seed:{hash}</code> or <code>delta:{tripId}:{scope}</code> Post-Process Attribution + license filtering n/a license_flags gate Store Persist retrieval + semantic outputs Retrieval/Semantic cache TTL adaptive Delivery Return structured JSON n/a Client offline sync optional <p>Cache Invalidation: event grid source update, manual edit, season boundary, license flag change, stale age threshold.</p>"},{"location":"architecture/#8-discrepancies-vs-mvp-architecture","title":"8. Discrepancies vs MVP Architecture","text":"Area Legacy / Extended MVP Now Rationale Primary DB Cosmos DB Azure SQL Lower initial cost &amp; simpler relational joins Cache Redis + multi-tier Deferred (in-memory placeholder) Volume not yet justifying managed Redis cost Enrichment Orchestration Functions + Data Factory + Event Grid Functions only Simplify early ingestion scope Provider Abstraction Full <code>PlacesProvider</code> interface Planned Post initial trip generation success Observability Freshness + TOS dashboards Basic latency + errors Add freshness after baseline stability <p>Last updated: September 2025 (extended section revisions)</p>"},{"location":"architecture/azure_overview/","title":"High-Level Azure Architecture","text":"<p>This document expands the platform view into Azure-specific layers, cost posture, and rationale for service selection.</p>"},{"location":"architecture/azure_overview/#layered-view","title":"Layered View","text":"<p>We group components into four layers to simplify reasoning about responsibilities and scaling decisions.</p>"},{"location":"architecture/azure_overview/#a-data-ingestion-storage","title":"A. Data Ingestion &amp; Storage","text":"Service Role Azure Functions Serverless scheduled &amp; event-driven ingestion (weather, events, Reddit, YouTube, holidays). Azure Logic Apps Low-code integration for RSS feeds, calendars, select social APIs. Azure Blob Storage Raw JSON, CSV, transcripts, media dumps. Immutable audit trail. Azure SQL Database Structured trip / event / geospatial reference data (can evolve to Flexible Server or Postgres if needed). Azure Cognitive Search Indexed content &amp; metadata for keyword + tag search and hybrid retrieval companion to vector/RAG path."},{"location":"architecture/azure_overview/#b-data-processing-enrichment","title":"B. Data Processing &amp; Enrichment","text":"Service Role Azure Databricks / Azure ML Pipelines ETL, feature engineering, batch NLP. Start with ML pipelines; add Databricks if Spark scale required. Azure Cognitive Services \u2013 Text Analytics Sentiment, key phrase / entity extraction for Reddit posts, YouTube transcripts, articles. Azure Maps Travel time, distance matrices, route info feeding itinerary scoring."},{"location":"architecture/azure_overview/#c-ml-model-hosting","title":"C. ML Model Hosting","text":"Service Usage Guidance Azure ML Endpoints Default for managed deployment (versioning, autoscaling, auth). Azure Container Instances (ACI) Lightweight, bursty, low-cost MVP serving (single model, modest QPS). Azure Kubernetes Service (AKS) Only when multi-model, GPU pooling, or traffic &gt; ACI/AML autoscale comfort."},{"location":"architecture/azure_overview/#d-frontend-api-layer","title":"D. Frontend &amp; API Layer","text":"Service Role Azure App Service Hosts backend API (FastAPI / ASP.NET Core) + optionally SSR frontend. Azure Static Web Apps Cheaper static React + Functions combo (edge distribution, built-in auth providers). Azure API Management Central gateway: rate limiting, subscription keys, future partner exposure of recommendation API."},{"location":"architecture/azure_overview/#2-ml-rag-workflow-current-target","title":"2. ML / RAG Workflow (Current Target)","text":"<ol> <li>Ingestion (Functions / Logic Apps) persist raw payloads to Blob + normalized entities to SQL.</li> <li>Cleaning &amp; enrichment via AML pipeline (or Databricks as scale grows).</li> <li>Feature engineering: join weather, events, holidays, social sentiment \u2192 feature vectors (store intermediate parquet in Blob / ADLS).</li> <li>Model training: start with LightFM / classic recommenders (implicit feedback) or scikit-learn baselines; progress to fine-tuned transformer classifiers for category &amp; intent.</li> <li>Deployment: AML Managed Endpoint (promotion dev \u2192 prod) or ACI for MVP.</li> <li>Recommendation / RAG API: orchestrates retrieval (Cognitive Search + future vector store), feature scoring, personalization.</li> <li>Feedback loop: user interactions logged (click/save/skip) \u2192 aggregation job updates implicit feedback matrices.</li> </ol>"},{"location":"architecture/azure_overview/#3-indicative-budget-130140-month-mvp","title":"3. Indicative Budget (~$130\u2013140 / month MVP)","text":"Service Purpose Est. Monthly Azure Functions Ingestion jobs (consumption) $5\u201310 Azure SQL (Basic) Structured reference data ~$5 Blob Storage Raw/unstructured payloads $2\u20135 Cognitive Search (Basic) Search index ~$40 Azure ML (Dev/Test) Training + hosted endpoint ~$50 App Service (Basic) Backend + simple frontend ~$15 Azure Maps Routing / distance APIs $5\u201310 Total ~$130\u2013140 <p>Costs are directional; apply Azure pricing calculator with region &amp; projected transaction volumes before committing.</p>"},{"location":"architecture/azure_overview/#cost-optimization-notes","title":"Cost Optimization Notes","text":"<ul> <li>Keep Functions on consumption until sustained &gt;70% of a basic plan.</li> <li>Defer Databricks spin-up until Spark or Delta features are justified.</li> <li>Consolidate model hosting (batch small models into one container) early on.</li> <li>Gate enrichment calls with cache-first strategy to reduce Maps &amp; Text Analytics spend.</li> </ul>"},{"location":"architecture/azure_overview/#4-why-azure-aligns","title":"4. Why Azure Aligns","text":"Need Azure Advantage Integrated AI + classic ML Combine OpenAI + Cognitive Services + custom AML models under unified IAM. Low-friction ingestion Functions + Logic Apps reduce glue code and idle cost. Gradual scale path ACI \u2192 AML Managed Endpoint \u2192 AKS as traffic &amp; models grow. Security &amp; Identity Azure AD B2C / Entra ID readiness for future user auth &amp; RBAC. Observability App Insights, Log Analytics, Monitor unify metrics &amp; tracing."},{"location":"architecture/azure_overview/#5-next-decisions-open-questions","title":"5. Next Decisions / Open Questions","text":"Topic Decision Needed Options / Notes Vector Store When to add &amp; which Start with Cognitive Search vector; revisit for Pinecone / RedisEF if advanced filtering/perf needs. Personalization Baseline LightFM vs MF vs embedding similarity Prototype offline AUC + hit-rate; choose lowest complexity meeting KPI. Geospatial SQL vs Postgres w/ PostGIS If advanced spatial queries (isochrones, complex polygons) escalate to Postgres. Batch Orchestration AML vs Data Factory vs Databricks Jobs AML pipelines first; add ADF if cross-service dependency graphs grow. Caching Strategy Redis tier &amp; eviction policy Start Basic tier, track hit ratio &amp; memory fragmentation."},{"location":"architecture/azure_overview/#6-risks-mitigations","title":"6. Risks &amp; Mitigations","text":"Risk Impact Mitigation Over-provisioned services Wasted budget Start smallest SKU; add autoscale thresholds early. Vendor feature lock-in Migration friction Use abstractions for search &amp; model inference layers. Data quality drift Recommendation decay Scheduled validation &amp; feature distribution monitoring. Latency spikes (cold Functions) User-perceived slowness Warm-up timer triggers; combine hot paths in App Service. Unbounded enrichment calls Cost blow-up Rate limit + caching + quota dashboards."},{"location":"architecture/azure_overview/#7-initial-kpis-draft","title":"7. Initial KPIs (Draft)","text":"KPI Target (MVP) P95 API Latency (Recommendation) &lt; 1200 ms Cache Hit Ratio (retrieval sets) &gt; 55% Model Retrain Cadence Weekly (or data delta &gt;10%) Index Freshness Lag &lt; 10 min for critical ingest Cost / 1k Recommendation Calls &lt; $0.40 <p>Last updated: September 2025</p>"},{"location":"architecture/rag_flow/","title":"RAG Flow Diagram","text":"<p>Visual diagram for the current RAG + caching interactions.</p> <p></p> <p>Source editable file: <code>rag_flow.excalidraw</code> (exported to <code>rag_flow.png</code>).</p> <p>Legacy extended diagram with storage emphasis lives in <code>architecture/README.md</code>.</p>"},{"location":"mockups/","title":"Mockups","text":"<p>Early UX visuals illustrating key user flows. Assets will evolve; filenames remain stable for docs links.</p> Screen Purpose Notes <code>dashboard.png</code> User landing / recent trips / recommendations Personalization tiles fed by cached retrieval sets. <code>trip_builder.png</code> Interactive itinerary assembly Inline RAG suggestions per day slot. <code>on_trip_mode.png</code> Mobile live trip view Offline caching, day progress, context-aware suggestions. <p>Design Principles:</p> <ol> <li>Fast clarity.</li> <li>Grounded transparency (attribution + source icons).</li> <li>Progressive disclosure (advanced filters tucked away).</li> <li>Trust &amp; compliance (clear licensing/usage indicators).</li> </ol> <p>Roadmap (Design):</p> <ul> <li>Add low\u2011fidelity wireframes</li> <li>Incorporate usability feedback sessions</li> <li>Add dark mode variants</li> </ul> <p>Last updated: September 2025 (content polished; removed placeholder language)</p>"},{"location":"mockups/homepage/","title":"Homepage Mockup","text":"<p>Tagline: Where your weekends come alive.</p>"},{"location":"mockups/homepage/#purpose","title":"Purpose","text":"<p>Convert curious visitors into early users by quickly conveying BloomTrip's differentiated weekend-focused, context-aware planning value.</p>"},{"location":"mockups/homepage/#included-sections","title":"Included Sections","text":"<ol> <li>Hero: Tagline + supporting copy emphasizing personalized weekend trip suggestions (interests, season, weather).</li> <li>Signup Form: Single email capture prominently below hero text.</li> <li>Trip Preview Carousel (teaser): Rotating sample trip cards (weekend escapes) to hint personalization depth.</li> <li> <p>Feature Highlights (three columns):</p> </li> <li> <p>Discover hidden gems</p> </li> <li>Stay in the know</li> <li> <p>Plan with ease</p> </li> <li> <p>Primary CTA Footer Bar: \"Start your next adventure today\"</p> </li> </ol>"},{"location":"mockups/homepage/#content-copy-draft","title":"Content Copy (Draft)","text":"<p>Hero Lead: Where your weekends come alive. Supporting: Forget endless planning. Get personalized weekend trip suggestions based on your interests, the season, and live weather. CTA Button (hero + footer): Start your next adventure today Feature 1: Discover hidden gems \u2014 Explore curated destinations tailored to your profile and preferences. Feature 2: Stay in the know \u2014 We factor in live weather updates to ensure your trips are always timely. Feature 3: Plan with ease \u2014 Receive ready\u2011to\u2011go itineraries that include maps, activities, and events.</p>"},{"location":"mockups/homepage/#design-notes","title":"Design Notes","text":"<ul> <li>Palette: Fresh green (primary action), sky blue (brand accent), warm coral (secondary CTA/emphasis)</li> <li>Typography: Poppins or Nunito (semi-rounded, approachable, high legibility)</li> <li>Imagery: Nature, camper vans, trails, seasonal landscapes (avoid stock overly staged scenes)</li> <li>Layout: Two-column hero (text + visual) collapsing to stacked on mobile</li> <li>Grid: 12-column desktop, 6-column tablet, single-column mobile</li> <li>Spacing: 8px base unit with 4x (32px) rhythm for section separation</li> <li>Buttons: Rounded medium radius, subtle elevation (shadow 2dp), accessible contrast (WCAG AA+)</li> </ul>"},{"location":"mockups/homepage/#accessibility","title":"Accessibility","text":"<ul> <li>Color contrast \u2265 4.5:1 for body text, \u2265 3:1 for large headings</li> <li>Form input labeled and associated with description</li> <li>Keyboard focus outlines preserved</li> <li>Alt text for primary imagery and feature icons</li> </ul>"},{"location":"mockups/homepage/#responsive-behavior","title":"Responsive Behavior","text":"<ul> <li>Carousel hides on very small viewports (&lt;360px) replaced by static sample cards</li> <li>Feature grid collapses 3 \u2192 2 \u2192 1 columns</li> <li>Footer CTA becomes sticky on mobile scroll (optional experiment)</li> </ul>"},{"location":"mockups/homepage/#implementation-guidance-react-example-skeleton","title":"Implementation Guidance (React Example Skeleton)","text":"<pre><code>import React from 'react';\n\nexport const Homepage: React.FC = () =&gt; {\n  return (\n    &lt;main&gt;\n      {/* Hero Section */}\n      &lt;section className=\"hero\"&gt;\n        &lt;div className=\"hero__text\"&gt;\n          &lt;h1&gt;Where your weekends come alive.&lt;/h1&gt;\n          &lt;p&gt;Forget endless planning. Get personalized weekend trip suggestions based on your interests, the season, and live weather.&lt;/p&gt;\n          &lt;form className=\"signup\" onSubmit={(e)=&gt;{e.preventDefault(); /* handle submit */}}&gt;\n            &lt;label htmlFor=\"email\" className=\"visually-hidden\"&gt;Email&lt;/label&gt;\n            &lt;input id=\"email\" type=\"email\" placeholder=\"Enter your email\" required /&gt;\n            &lt;button type=\"submit\"&gt;Sign up for free&lt;/button&gt;\n          &lt;/form&gt;\n        &lt;/div&gt;\n        &lt;div className=\"hero__visual\"&gt;\n          {/* Image / slideshow placeholder */}\n          &lt;div className=\"hero__image\" aria-hidden=\"true\" /&gt;\n        &lt;/div&gt;\n      &lt;/section&gt;\n\n      {/* Feature Highlights */}\n      &lt;section className=\"features\"&gt;\n        &lt;ul className=\"feature-list\"&gt;\n          &lt;li&gt;\n            &lt;h3&gt;Discover hidden gems&lt;/h3&gt;\n            &lt;p&gt;Explore curated destinations tailored to your profile and preferences.&lt;/p&gt;\n          &lt;/li&gt;\n          &lt;li&gt;\n            &lt;h3&gt;Stay in the know&lt;/h3&gt;\n            &lt;p&gt;We factor in live weather updates to ensure your trips are always timely.&lt;/p&gt;\n          &lt;/li&gt;\n          &lt;li&gt;\n            &lt;h3&gt;Plan with ease&lt;/h3&gt;\n            &lt;p&gt;Receive ready-to-go itineraries that include maps, activities, and events.&lt;/p&gt;\n          &lt;/li&gt;\n        &lt;/ul&gt;\n      &lt;/section&gt;\n\n      {/* Footer CTA */}\n      &lt;section className=\"cta-footer\"&gt;\n        &lt;h2&gt;Start your next adventure today&lt;/h2&gt;\n        &lt;button&gt;Get Started&lt;/button&gt;\n      &lt;/section&gt;\n    &lt;/main&gt;\n  );\n};\n</code></pre>"},{"location":"mockups/homepage/#css-token-suggestions","title":"CSS Token Suggestions","text":"Token Example Purpose --color-primary #02A551 Actions / CTAs --color-accent #2196F3 Highlights / links --color-warm #FF7F57 Secondary emphasis --color-bg #FFFFFF Background --color-bg-alt #F5F9F7 Section contrast --radius-sm 4px Inputs --radius-md 8px Cards / buttons --shadow-sm 0 2px 4px rgba(0,0,0,0.08) Light elevation"},{"location":"mockups/homepage/#validation-checklist","title":"Validation Checklist","text":"<ul> <li>[ ] All text readable on mobile</li> <li>[ ] Form accessible (labels + errors)</li> <li>[ ] Button focus state visible</li> <li>[ ] Lighthouse performance \u2265 90</li> <li>[ ] CLS &lt; 0.05 (avoid layout shift)</li> </ul>"},{"location":"mockups/homepage/#future-enhancements","title":"Future Enhancements","text":"<ul> <li>A/B test alternative hero subcopy</li> <li>Add social proof (user counter / testimonial placeholder)</li> <li>Inline privacy note under email field</li> <li>Add geo-personalized teaser (\"Looks sunny near Brasov this weekend\")</li> </ul> <p>Last updated: 2025-09-05</p>"},{"location":"mockups/itinerary-map-page/","title":"Itinerary Page Mockup: Forest, Lakes &amp; Mountain Loops","text":"<p> Figure 3. Core itinerary detail layout with dual column: editable day segments (left) and interactive map with custom BloomTrip markers (right).</p> <p>BloomTrip-style detailed itinerary view with embedded map (Google or Bing) highlighting B\u0103neasa Forest trails, Snagov Lake, Moara Vl\u0103siei, and mountain loops near Sinaia using a custom rounded, nature\u2011inspired icon set.</p>"},{"location":"mockups/itinerary-map-page/#1-purpose-position-in-flow","title":"1. Purpose &amp; Position in Flow","text":"<p>This page appears after a user taps \u201cChoose this trip\u201d from a divergent / broad results screen (see <code>search-refinement.md</code>). It transitions the user from idea exploration to trip planning ownership.</p> <p>Key goals:</p> <ul> <li>Provide immediate visual context (hero + interactive map).</li> <li>Explain \u201cWhy it matches\u201d (transparency + trust).</li> <li>Offer structured, editable Day-by-Day plan.</li> <li>Enable lightweight personalization before commitment (swap, adjust duration, companions, budget lens).</li> <li>Instrument feedback loops (Save, Boost Similar, Mute, Explain Choice).</li> </ul>"},{"location":"mockups/itinerary-map-page/#2-page-structure-high-level-wire-blocks","title":"2. Page Structure (High-Level Wire Blocks)","text":"<ol> <li>Header Card: Title, date window selector, profile tags, weather snippet.</li> <li>Match Rationale Panel: Signals that fired (interests, weather window, distance radius).</li> <li>Dual Layout Region (responsive):</li> <li>Left: Day / Segment cards (scrollable column).</li> <li>Right: Embedded Map (sticky on desktop, collapsible on mobile).</li> <li>Personalization Tray: Inline controls (Swap, Add Day, Adjust Pace, Budget Filter toggle).</li> <li>Logistics Strip: Drive segments, charging points, facilities.</li> <li>Save / Share / Export Bar.</li> <li>Feedback Footer: Micro-actions + \u201cNot quite right? Adjust your trip\u201d.</li> </ol>"},{"location":"mockups/itinerary-map-page/#3-map-integration-options","title":"3. Map Integration Options","text":"Aspect Google Maps JS API Bing Maps Web Control Neutral (Leaflet / Vector Tiles) Route Rendering Directions + polylines styling Directions + custom layer Use precomputed polyline / GeoJSON Custom Icons <code>new google.maps.Marker({icon: svg})</code> <code>Microsoft.Maps.Pushpin</code> w/ SVG Full SVG markers via layer Offline / Caching Strategy Limited (Terms) Limited Tile + route caching possible Licensing API key / usage based Key w/ usage tiers Depends on tile source <p>Decision (MVP): Support Google + Bing provider abstraction via a <code>MapProvider</code> interface so itinerary JSON is provider-agnostic.</p> <pre><code>interface MapProvider {\n  init(container: HTMLElement, opts: { center: [number, number]; zoom: number }): Promise&lt;void&gt;;\n  addMarker(poi: PoiMarker): void;\n  addRoute(route: EncodedRoute | GeoJSON.FeatureCollection): void;\n  highlight(id: string): void;\n  fitTo(ids: string[]): void;\n}\n</code></pre>"},{"location":"mockups/itinerary-map-page/#4-custom-icon-system","title":"4. Custom Icon System","text":"<p>Design principles: rounded corners, subtle shadow (elevation 1), saturated organic palette, white inner pictogram.</p> Semantic Color (Hex) Icon Concept Example ID Forest Trail <code>#2E8F48</code> Leaf / path swirl <code>poi_forest</code> Lake / Water <code>#0D84D9</code> Gentle wave triple <code>poi_lake</code> Cultural Stop <code>#FF8A34</code> Stylized arch / column <code>poi_culture</code> Camp / Camper <code>#1B74D2</code> (outline) + green dot Camper silhouette <code>poi_camper</code> Scenic View <code>#6F4DF5</code> Mountain + sun <code>poi_view</code> <p>SVG Marker Template (12px corner radius):</p> <pre><code>&lt;svg width=\"48\" height=\"56\" viewBox=\"0 0 48 56\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"&gt;\n  &lt;defs&gt;\n    &lt;filter id=\"drop1\" x=\"-4\" y=\"-4\" width=\"56\" height=\"64\" filterUnits=\"userSpaceOnUse\"&gt;\n      &lt;feOffset dy=\"2\"/&gt;&lt;feGaussianBlur stdDeviation=\"2\"/&gt;&lt;feColorMatrix type=\"matrix\" values=\"0 0 0 0 0  0 0 0 0 0  0 0 0 0 0  0 0 0 0.15 0\"/&gt;&lt;feBlend mode=\"normal\" in2=\"BackgroundImageFix\" result=\"shadow\"/&gt;\n    &lt;/filter&gt;\n  &lt;/defs&gt;\n  &lt;g filter=\"url(#drop1)\"&gt;\n    &lt;path d=\"M24 56c8-14.4 22-20.4 22-34A22 22 0 0 0 2 22c0 13.6 14 19.6 22 34Z\" fill=\"#2E8F48\"/&gt;\n    &lt;circle cx=\"24\" cy=\"22\" r=\"12\" fill=\"white\"/&gt;\n    &lt;!-- Replace inner glyph --&gt;\n    &lt;path d=\"M20 26c4-6 4-10 8-12-1 4-1 8-8 12Z\" fill=\"#2E8F48\"/&gt;\n  &lt;/g&gt;\n&lt;/svg&gt;\n</code></pre> <p>Replace color + internal glyph per semantic.</p>"},{"location":"mockups/itinerary-map-page/#5-sample-itinerary-map-payload-provider-agnostic","title":"5. Sample Itinerary Map Payload (Provider-Agnostic)","text":"<pre><code>{\n  \"tripId\": \"forest_lake_mountain_weekend_2025_09_13\",\n  \"center\": [44.65, 26.20],\n  \"zoom\": 8,\n  \"pois\": [\n    {\"id\": \"baneasa_forest\", \"name\": \"B\u0103neasa Forest Trails\", \"kind\": \"forest\", \"coords\": [44.5299, 26.0802], \"activities\": [\"e-bike\",\"nature\"], \"durationMin\": 30},\n    {\"id\": \"snagov_lake\", \"name\": \"Snagov Lake\", \"kind\": \"lake\", \"coords\": [44.6944, 26.1900], \"activities\": [\"picnic\",\"kayak\"], \"durationMin\": 60},\n    {\"id\": \"moara_vlasiei\", \"name\": \"Moara Vl\u0103siei\", \"kind\": \"culture\", \"coords\": [44.6805, 26.0487], \"activities\": [\"ride\",\"lunch\"], \"durationMin\": 45},\n    {\"id\": \"sinaia_loop\", \"name\": \"Sinaia Mountain Loop\", \"kind\": \"view\", \"coords\": [45.3506, 25.5474], \"activities\": [\"trail\",\"scenic\"], \"durationMin\": 120}\n  ],\n  \"routes\": [\n    {\"id\": \"segment_day1_forest_to_snagov\", \"polyline\": \"_seI}u~hC...\", \"color\": \"#0D84D9\", \"mode\": \"drive\"},\n    {\"id\": \"segment_day2_snagov_to_sinaia\", \"polyline\": \"ymvJc`d~E...\", \"color\": \"#2E8F48\", \"mode\": \"drive\"}\n  ],\n  \"meta\": {\"units\": \"metric\", \"generatedAt\": \"2025-09-05T08:30:00Z\"}\n}\n</code></pre> <p>(Polylines truncated.)</p>"},{"location":"mockups/itinerary-map-page/#6-embedding-examples","title":"6. Embedding Examples","text":""},{"location":"mockups/itinerary-map-page/#google-maps-simplified","title":"Google Maps (simplified)","text":"<pre><code>&lt;div id=\"map\" style=\"height:480px\"&gt;&lt;/div&gt;\n&lt;script src=\"https://maps.googleapis.com/maps/api/js?key=YOUR_KEY&amp;libraries=maps\"&gt;&lt;/script&gt;\n&lt;script type=\"module\"&gt;\n  import data from './itinerary.json' assert { type: 'json' };\n  const map = new google.maps.Map(document.getElementById('map'), {center:{lat:data.center[0],lng:data.center[1]}, zoom:data.zoom});\n  const iconFor = kind =&gt; ({ url: `/icons/${kind}.svg`, scaledSize: new google.maps.Size(48,56) });\n  data.pois.forEach(p =&gt; new google.maps.Marker({map, position:{lat:p.coords[0],lng:p.coords[1]}, icon: iconFor(p.kind), title: p.name}));\n  // Decode polyline example (requires polyline decoder util)\n&lt;/script&gt;\n</code></pre>"},{"location":"mockups/itinerary-map-page/#bing-maps-simplified","title":"Bing Maps (simplified)","text":"<pre><code>&lt;div id=\"map\" style=\"height:480px\"&gt;&lt;/div&gt;\n&lt;script type=\"text/javascript\" src=\"https://www.bing.com/api/maps/mapcontrol?key=YOUR_KEY\" async defer&gt;&lt;/script&gt;\n&lt;script&gt;\nfunction loadMapScenario(){\n  fetch('itinerary.json').then(r=&gt;r.json()).then(data =&gt; {\n    const map = new Microsoft.Maps.Map('#map',{ center: new Microsoft.Maps.Location(data.center[0], data.center[1]), zoom: data.zoom });\n    data.pois.forEach(p =&gt; {\n      const pin = new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(p.coords[0], p.coords[1]), { icon: `/icons/${p.kind}.svg`, anchor: new Microsoft.Maps.Point(24,56) });\n      map.entities.push(pin);\n    });\n  });\n}\n&lt;/script&gt;\n</code></pre>"},{"location":"mockups/itinerary-map-page/#7-interaction-model","title":"7. Interaction Model","text":"Action Result Hover / Tap POI card Map marker pulses + route segment highlight (thicker stroke) Map marker click Scrolls corresponding segment card into view + brief rationale toast Swap Activity Opens modal listing compatible alternatives (same difficulty tag) Adjust Duration Regenerates affected route segments + recalculates drive time slack Budget Filter Re-colors costlier POIs (amber) + suggests cheaper substitutes Save / Boost Similar Stores vector embedding for reinforcement + logs telemetry <p>Keyboard support: <code>Tab</code> cycles markers \u2192 pressing <code>Enter</code> focuses card. ARIA labels include <code>name, activity types, estimated duration</code>.</p>"},{"location":"mockups/itinerary-map-page/#8-accessibility-internationalization","title":"8. Accessibility &amp; Internationalization","text":"<ul> <li>WCAG AA contrast for marker inner glyph (white on saturated base &gt; 4.5:1). </li> <li>Provide text alt list of POIs beneath map for screen readers.</li> <li>Use locale-aware formatting for distance/time (e.g., km vs mi).</li> <li>Diacritics preserved for Romanian names (UTF\u20118, no ASCII fallback).</li> </ul>"},{"location":"mockups/itinerary-map-page/#9-performance-considerations","title":"9. Performance Considerations","text":"Concern Mitigation First Paint Delay Lazy-load map script after header visible (<code>IntersectionObserver</code>). Marker Jank Batch marker adds inside <code>requestIdleCallback</code> for large sets. Excess Route Decoding Pre-simplify polylines server-side (Douglas-Peucker). Mobile Memory Offer static preview image \u2192 tap to load full map."},{"location":"mockups/itinerary-map-page/#10-telemetry-events","title":"10. Telemetry Events","text":"Event Payload Snippet <code>itinerary_view</code> <code>{ tripId, profileTags, weatherWindow }</code> <code>poi_focus</code> <code>{ tripId, poiId, source: 'map|list' }</code> <code>swap_requested</code> <code>{ tripId, segmentId, originalPoiId }</code> <code>duration_adjust</code> <code>{ tripId, deltaDays }</code> <code>export_invoke</code> <code>{ tripId, format: 'pdf|calendar' }</code> <code>feedback_action</code> <code>{ tripId, targetId, action: 'save|boost|mute' }</code>"},{"location":"mockups/itinerary-map-page/#11-data-model-alignment","title":"11. Data Model Alignment","text":"<p>Each POI maps to a <code>Petal</code> (see <code>specs/petal_schema.md</code>) and segments aggregate petals into a <code>TripDay</code>. Route metadata supplements petal relational edges (sequence + segment travel mode).</p>"},{"location":"mockups/itinerary-map-page/#12-future-enhancements","title":"12. Future Enhancements","text":"<ul> <li>Offline snapshot (static vector tile + simplified polylines).</li> <li>3D terrain preview for mountain segments.</li> <li>Battery consumption estimator for e\u2011bike legs.</li> <li>Collaborative live editing (WebSocket diff sync).</li> <li>Heatmap overlay (popular paths vs personal recommendations).</li> </ul>"},{"location":"mockups/itinerary-map-page/#13-cross-links","title":"13. Cross-Links","text":"<ul> <li>Source Itinerary Preview: <code>weekend-bucharest-ebike.md</code></li> <li>Divergent Search Entry Point: <code>search-refinement.md</code></li> <li>RAG Flow &amp; Caching: <code>rag_pipeline.md</code> (for regeneration triggers)</li> </ul> <p>Last updated: 2025-09-05</p>"},{"location":"mockups/itinerary-refinement-detail/","title":"Itinerary Detail &amp; Refinement Mockup","text":"<p> Figure 4. Enhanced itinerary refinement view with smart suggestions panel, refinement rail, and synchronized map/segment interactions.</p> <p>This mockup extends the base itinerary map page by adding real\u2011time refinement, smart enhancement suggestions, and feedback instrumentation so a static idea becomes a living, user\u2011shaped plan.</p>"},{"location":"mockups/itinerary-refinement-detail/#1-purpose","title":"1. Purpose","text":"<p>Transform a selected suggestion (\"Choose this trip\") into an interactive planning surface where the user can: tweak scope, swap activities, extend or shrink duration, inject companions or constraints, and immediately see regenerated rationale \u2014 all while preserving provenance (sources) and personalization continuity.</p>"},{"location":"mockups/itinerary-refinement-detail/#2-page-layout-regions","title":"2. Page Layout Regions","text":"Region Description Key Components A. Header Card Title, date window selector, profile match badges Trip title, date picker, badges (E\u2011Bike, Nature, Camper, Family) B. Hero Media Large hero image or carousel (forest, lake, camper) Responsive image, optional video teaser C. Refinement Rail Always\u2011visible quick actions Add Details, Adjust Duration, Swap Activity, Add Companions, Budget Filter, Weather Mode Toggle D. Smart Suggestions Panel Dynamic improvement ideas \"Ideas to Make It Even Better\" card with contextual chips E. Day / Segment Column Ordered day blocks with editable segments Segment cards, drag handle, time badges, action menu F. Interactive Map POIs + routes + overlays (sticky/right) Custom SVG markers, route polylines, layer toggles G. Action Footer Persistence &amp; collaboration Save, Share, Export, Adjust Again H. Feedback Micro Bar Reinforcement signals Save, Boost, Mute, Explain buttons per segment"},{"location":"mockups/itinerary-refinement-detail/#3-refinement-actions-ux-flows","title":"3. Refinement Actions &amp; UX Flows","text":"Action UX Pattern Backend Impact Add Details Inline prompt (natural language) Triggers RAG adjust prompt; stores refinement intent token Adjust Duration Dropdown (1\u20134 days) or slider Re-query candidate POIs for added/removed days; recalc drive &amp; rest windows Swap Activity Modal with filtered alternatives (same tags) Replacement logged; original kept for undo; feedback event <code>swap_activity</code> Add Companions Chip selector (Kids, Teen, Pet, Friends) Re-scores family_fit &amp; safety tags; updates user profile delta Budget Filter Range control (Low \u2194 Higher) Filters cost_band, suggests substitutes; caches previous plan for revert Weather Mode Toggle (Outdoor / Mixed / Indoor fallback) Adjusts weather_suitability weighting + alternative retrieval"},{"location":"mockups/itinerary-refinement-detail/#4-smart-suggestions-ideas-to-make-it-even-better","title":"4. Smart Suggestions (\u201cIdeas to Make It Even Better\u201d)","text":"<p>Dynamic chips generated from context gaps:</p> <ul> <li>\"Add a scenic detour\" (if elevation scenic score low)</li> <li>\"Include a kid challenge stop\" (if teen flag true &amp; no active challenge)</li> <li>\"Add a low\u2011light indoor fallback\" (if afternoon showers risk)</li> <li>\"Insert a local food stop\" (if no dining anchor on Day 1)</li> </ul> <p>Each chip triggers a lightweight retrieval + localized partial regeneration rather than full itinerary rewrite (scope control reduces token cost &amp; latency).</p>"},{"location":"mockups/itinerary-refinement-detail/#5-segment-card-structure","title":"5. Segment Card Structure","text":"<pre><code>&lt;SegmentCard&gt;\n  Icon (semantic color)\n  Title (e.g., B\u0103neasa Forest Loop)\n  Tags: [E\u2011Bike][Forest][Shaded]\n  Time Block: 09:00\u201311:00 (editable)\n  Distance / Elev Gain / Drive Time Chips\n  Rationale (1 sentence) + (Explain) link\n  Inline Actions: Save | Boost | Mute | Swap | Move | Details\n&lt;/SegmentCard&gt;\n</code></pre> <p>Inline edit affordances: time picker, duration drop\u2011down, optional notes field.</p>"},{"location":"mockups/itinerary-refinement-detail/#6-map-enhancements","title":"6. Map Enhancements","text":"Feature Behavior Marker Hover / Card Sync Hover highlights card; focus scrolls into view Layer Toggles Food \u2022 Scenic \u2022 Family \u2022 Charging \u2022 Weather Risk Route Segments Color-coded by day (Day1 blue, Day2 green, etc.) Offline Preview Static image fallback before script load Selection Add Clicking empty map area opens \"Add Nearby Stop\" search (radius preset)"},{"location":"mockups/itinerary-refinement-detail/#7-custom-marker-palette-bloomtrip","title":"7. Custom Marker Palette (BloomTrip)","text":"Kind Base Color Inner Glyph Forest / Trail #2E8F48 Leaf / path swirl Lake / Water #0D84D9 Wave triple Scenic View #6F4DF5 Mountain + sun Camper / Overnight #1B74D2 Camper silhouette Food / Local #FF7043 Utensils rounded Cultural / Heritage #FDBA4D Arch / column Fallback / Indoor #455A64 Roof silhouette <p>All markers share 48\u00d756 rounded pin SVG with white inner circle.</p>"},{"location":"mockups/itinerary-refinement-detail/#8-adjust-prompt-template-delta-regeneration","title":"8. Adjust Prompt Template (Delta Regeneration)","text":"<pre><code>System: You are a precise trip refinement planner. Modify ONLY the specified parts; preserve unchanged segments &amp; original sources. Cite sources.\nUser: Original segment JSON (abbrev)...\nAdjustment: \"Add a lakeside picnic stop after the forest loop and shorten the afternoon ride.\"\nConstraints: Drive time \u2264 2h/day; family + teen; e\u2011bike friendly focus.\nReturn: Updated segments array + rationale deltas per changed segment.\n</code></pre>"},{"location":"mockups/itinerary-refinement-detail/#9-telemetry-events","title":"9. Telemetry Events","text":"Event Payload Example itinerary_refine {tripId, userId, action:\"add_details\", tokens, latencyMs} segment_swap {tripId, segmentId, oldPoi, newPoi} duration_change {tripId, oldDays, newDays} chip_apply {tripId, chipType} map_marker_focus {tripId, poiId, source:\"map_or_card\"} export_invoke {tripId, format:\"pdf_or_calendar\"}"},{"location":"mockups/itinerary-refinement-detail/#10-performance-cost-notes","title":"10. Performance &amp; Cost Notes","text":"Concern Mitigation Full itinerary re-generation Delta prompts (segment scope) Excess embeddings Cache POI embeddings; only embed new user free\u2011text additions Map script weight Lazy load after first interaction / hero in view Ranking latency Pre-rank alternative POIs nightly; in-session only apply lightweight re-score"},{"location":"mockups/itinerary-refinement-detail/#11-accessibility","title":"11. Accessibility","text":"<ul> <li>All actions reachable via keyboard (Tab \u2192 segment \u2192 Enter to expand actions)</li> <li>ARIA roles: list (segments), listitem (segment), button (swap/add)</li> <li>High contrast marker glyphs (WCAG AA)</li> <li>Motion reduction: disable map marker pulse when reduced motion enabled</li> </ul>"},{"location":"mockups/itinerary-refinement-detail/#12-cross-links","title":"12. Cross-Links","text":"<ul> <li>Base Itinerary Map Concept: <code>itinerary-map-page.md</code></li> <li>Divergent Search Entry: <code>search-refinement.md</code></li> <li>Source Preview Example: <code>weekend-bucharest-ebike.md</code></li> </ul> <p>Last updated: 2025-09-05</p>"},{"location":"mockups/itinerary-refinement-detail/#13-live-petals-drag-drop-interaction","title":"13. Live Petals Drag &amp; Drop Interaction","text":"<p> Figure 5. Live Petals drag\u2011and\u2011drop: user drags a saved / popular Petal from the suggestions rail onto a specific day segment; the segment inserts inline, route polyline + ordering update in real time, and a delta regeneration prompt updates only affected rationale.</p>"},{"location":"mockups/itinerary-refinement-detail/#purpose","title":"Purpose","text":"<p>Accelerate micro-adjustments by letting users visually compose itineraries: add, reorder, or replace activities (\"Petals\") directly on the map or within the day column without a full textual prompt.</p>"},{"location":"mockups/itinerary-refinement-detail/#interaction-flow","title":"Interaction Flow","text":"<ol> <li>User hovers a Petal chip (Saved or Popular) \u2192 map highlights candidate insertion anchors (gap markers between existing segments).</li> <li>Drag start emits <code>petal_drag_start</code> telemetry; route preview ghost line renders (dashed).</li> <li>Drop onto a gap (inserts new segment with provisional time estimate) or onto an existing segment (opens swap mini\u2011modal to confirm replace vs insert position).</li> <li>System issues a constrained delta prompt containing ONLY impacted segments (preceding + new + following) for rationale + timing recalculation.</li> <li>UI optimistic\u2011updates ordering &amp; route polyline; reconciliation occurs when regeneration returns (diff merges if minor duration drift).</li> </ol>"},{"location":"mockups/itinerary-refinement-detail/#key-constraints","title":"Key Constraints","text":"<ul> <li>Max 2 concurrent optimistic insertions (queue additional interactions with subtle toast).</li> <li>Reject drop if added drive time would exceed daily limit (pre-check distance matrix estimate &lt; threshold).</li> <li>Maintain provenance: newly inserted Petal retains source + popularity metadata.</li> </ul>"},{"location":"mockups/itinerary-refinement-detail/#visual-cues","title":"Visual Cues","text":"State Cue Drag Hover (valid) Anchor slot glows + subtle scale Drag Hover (invalid) Slot shows red outline + pulse Optimistic Insert Segment card skeleton shimmer Reconciled Brief green check icon fade-in"},{"location":"mockups/itinerary-refinement-detail/#telemetry-additions","title":"Telemetry Additions","text":"Event Payload petal_drag_start {tripId, petalId, source:\"saved|popular\"} petal_drag_cancel {tripId, petalId, durationMs} petal_insert {tripId, petalId, positionIndex, optimistic:true} petal_swap {tripId, oldSegmentId, newPetalId} delta_regen_invoke {tripId, scope:\"segments\", count:3, tokens}"},{"location":"mockups/itinerary-refinement-detail/#delta-prompt-insert-example","title":"Delta Prompt (Insert Example)","text":"<pre><code>System: You are an itinerary delta adjuster. Recalculate ONLY timing + rationale for affected window.\nContext: JSON for segments 3\u20135 (before insertion) + new Petal metadata.\nUser Action: Inserted petal_id=snagov_picnic after segment 3.\nConstraints: Keep total daily drive \u2264 2h, preserve prior segment ordering.\nReturn: Updated segments 3\u20136 (ISO start times, durations, rationale_deltas[]).\n</code></pre>"},{"location":"mockups/itinerary-refinement-detail/#error-conflict-handling","title":"Error / Conflict Handling","text":"<ul> <li>If regeneration increases drive time beyond constraint: revert insertion (toast: \"Couldn\u2019t fit that \u2014 try a closer stop\").</li> <li>If user performs second drag before first delta resolves: show inline spinner badge on pending segment(s).</li> </ul>"},{"location":"mockups/itinerary-refinement-detail/#accessibility","title":"Accessibility","text":"<ul> <li>Petals list supports keyboard: Enter = pick up, Arrow keys = move focus among anchors, Space = drop.</li> <li>Live region announces: \"Inserted Picnic Stop after Forest Loop.\"</li> </ul> <p>Figure 5 added &amp; section updated: 2025-09-05</p>"},{"location":"mockups/navigation-picker/","title":"Navigation Picker (Multi-App Launch Screen)","text":"<p> Figure 7. Navigation Picker: post\u2011commit (or Resume &gt; Navigate) screen offering Google Maps, Apple Maps, or Waze with preloaded route + waypoints and trip summary context.</p>"},{"location":"mockups/navigation-picker/#1-purpose","title":"1. Purpose","text":"<p>Provide a frictionless handoff from planning to real-world movement. Users select their preferred navigation app and continue the itinerary with correct ordering of key Petals (POIs) and timing assumptions.</p> <p>Appears when:</p> <ul> <li>User taps \u201cNavigate\u201d from: Trip In Progress (after save) or a committed trip view.</li> <li>User resumes a trip mid-route and requests directions.</li> </ul>"},{"location":"mockups/navigation-picker/#2-core-elements","title":"2. Core Elements","text":"Element Description Notes Title Block \u201cNavigate\u201d + Trip Name Trip name truncated w/ ellipsis after 1 line Prompt \u201cWhich app would you like to use?\u201d Localized string key: <code>nav_picker.prompt</code> App Option Cards Icon + Label + Right Arrow (focusable) Order = last used first (persisted) Route Summary Distance, total petals, estimated travel time Travel time cached from last generation or on-demand calc Context Chip Strip Mode icons (\ud83d\ude90, \ud83d\udeb2) + companions tags Reinforces personalization Dismiss / Back Returns user to trip view ESC / swipe-down on mobile sheet variant"},{"location":"mockups/navigation-picker/#3-deep-link-formats","title":"3. Deep Link Formats","text":"Provider Link Template Waypoint Support Notes Google Maps <code>https://www.google.com/maps/dir/?api=1&amp;origin={lat1},{lon1}&amp;destination={latN},{lonN}&amp;waypoints={lat2},{lon2}\\|...</code> Up to ~10 consumer waypoints Encode <code>travelmode=driving\\|bicycling</code> when relevant Apple Maps <code>http://maps.apple.com/?saddr={lat1},{lon1}&amp;daddr={latN},{lonN}</code> Limited (multi via <code>daddr=lat,long+to:lat,long</code>) Fallback: only origin/destination if &gt; 1 mid stop Waze <code>https://waze.com/ul?ll={latN},{lonN}&amp;navigate=yes</code> Single destination Sequential multi-stop: relaunch after each arrival (optional prompt)"},{"location":"mockups/navigation-picker/#waypoint-compression-strategy","title":"Waypoint Compression Strategy","text":"<ol> <li>Always include origin (first segment start) and final destination (last overnight / end Petal).</li> <li>Include intermediate high-value Petals (priority order: explicit user \u201cmust keep\u201d flags &gt; overnight &gt; longest duration &gt; scenic rating).</li> <li>If waypoint limit exceeded: collapse adjacent low-impact stops into a single instruction summary note (shown in an inline tip before launch).</li> </ol>"},{"location":"mockups/navigation-picker/#4-route-summary-construction","title":"4. Route Summary Construction","text":"Metric Source Fallback Total Distance Precomputed aggregator on commit On-demand distance matrix if stale &gt; 6h Est Travel Time Summed drive segments + buffer (traffic factor) Live request to provider ETA API (if token budget) Petal Count Length of segment array (activity segments only) n/a Modes Present Aggregated from segment tags Derive from icons table"},{"location":"mockups/navigation-picker/#5-telemetry","title":"5. Telemetry","text":"Event Payload Example nav_picker_view {tripId, userId, candidateProviders:[\"google\",\"apple\",\"waze\"], petals:11} nav_picker_select {tripId, provider:\"google\", waypoints:7} nav_picker_limit_trim {tripId, removed:3, kept:7} nav_launch_error {tripId, provider:\"apple\", code:\"APP_NOT_AVAILABLE\"} nav_relaunch_next_stop {tripId, provider:\"waze\", nextStopId:\"snagov_lake\"}"},{"location":"mockups/navigation-picker/#6-error-edge-handling","title":"6. Error / Edge Handling","text":"Scenario Handling App not installed (mobile) Detect scheme failure \u2192 show inline sheet offering other apps + \u201cCopy route link\u201d Excess waypoints Apply compression strategy; show toast: \u201cSimplified route (some short stops grouped).\u201d Offline / low connectivity Present cached polyline static preview + allow copy coordinates Mixed travel modes (e\u2011bike + drive) Prefer <code>driving</code> for backbone; inject note: \u201cSegment 3 is ride-only \u2013 switch to cycling after parking.\u201d Permission denied (location) Prompt OS request; if denied, fallback to origin as first Petal coordinates"},{"location":"mockups/navigation-picker/#7-accessibility","title":"7. Accessibility","text":"<ul> <li>Each app card: role=button + <code>aria-label=\"Open in Google Maps\"</code> style pattern.</li> <li>Keyboard order: top to bottom, Enter to launch, Space to focus details.</li> <li>Focus ring meets contrast AA (outline offset 2px, brand accent color).</li> <li>Voice summary preceding list: screen reader live region describing route summary.</li> </ul>"},{"location":"mockups/navigation-picker/#8-security-privacy-notes","title":"8. Security &amp; Privacy Notes","text":"Concern Mitigation Leaking personal waypoint names in URL Use sanitized short labels or omit names; rely on coordinates Over-sharing user profile tags Keep companions/mode local; not embedded in external link Stale link reuse Append ephemeral <code>ts</code> query param so analytics can detect outdated launches"},{"location":"mockups/navigation-picker/#9-future-enhancements","title":"9. Future Enhancements","text":"<ul> <li>Add \u201cCopy GPX\u201d / \u201cDownload KML\u201d for advanced offline use.</li> <li>Offer cycling vs driving route toggle (Google &amp; Apple only) prior to launch.</li> <li>Multi-day navigation segmentation (launch Day N subset only).</li> <li>Auto-detect installed apps and gray out unavailable options on desktop.</li> </ul> <p>Figure 7 added: 2025-09-05 (image pending upload as <code>navigation-picker.png</code>)</p>"},{"location":"mockups/navigation-picker/#10-implementation-checklist-dev-aid","title":"10. Implementation Checklist (Dev Aid)","text":"Item Status Decide waypoint selection heuristic Planned Implement provider detection (UA + scheme probe) Planned Add telemetry hooks Planned Compression &amp; toast messaging Planned Accessible card semantics Planned <p>Cross-links: <code>trip-in-progress.md</code>, <code>itinerary-map-page.md</code>, <code>itinerary-refinement-detail.md</code></p>"},{"location":"mockups/on-trip-mode-transition/","title":"On-Trip Mode Transition (From Inspiration to Live Navigation)","text":"<p> Figure 11. On\u2011Trip Mode (mobile): live map + \"Up Next\" focus card, Nearby Petals rail, quick navigation/actions, and dynamic discovery banner.</p>"},{"location":"mockups/on-trip-mode-transition/#1-purpose","title":"1. Purpose","text":"<p>Provide a seamless shift from planning / inspiration (dashboard, saved petal, seasonal suggestion) into an in-motion experience that preserves itinerary context while surfacing opportunistic nearby petals.</p>"},{"location":"mockups/on-trip-mode-transition/#2-multi-entry-paths-into-a-trip","title":"2. Multi-Entry Paths into a Trip","text":"Entry Source User Action Initialization Behavior Seasonal / Promo Card (e.g. Autumn Festival) Plan This Trip Seeds Trip Builder with promo petal as Day 1 anchor; derives default date (next weekend) Saved Petal Add to Trip (no active trip) Creates draft trip: petal as first activity; prompts for date range Recommended Petal (Suggestions rail) Start Trip Generates scaffold (cluster of complementary petals) using preference-weighted retrieval Existing Draft Trip Continue / Navigate Enters Trip In Progress state with current day highlighted Direct Deep Link (shared trip) Open Link Loads committed trip; offers \"Start Navigation\" if today within date range"},{"location":"mockups/on-trip-mode-transition/#3-state-transition-overview","title":"3. State Transition Overview","text":"State Source Trigger Key UI Differences Caching Notes Builder (Draft) New plan initialization Editable sequence, drag &amp; swap, AI refine chips Retrieval set + draft generation cache Trip In Progress (Pre-Commit) User shifts focus to execution (e.g. presses Navigate) Day cards + live map + commit bar Adds live location polling (opt-in) On\u2011Trip Mode (Active) Trip committed + user starts travel Up Next card pinned, minimized editing, quick actions bar Location &amp; proximity caches (nearby petals) Post-Trip Recap End date passed / user completes Summary metrics, feedback prompts Feedback submission flushes popularity deltas"},{"location":"mockups/on-trip-mode-transition/#4-core-ui-regions-on-trip-mode","title":"4. Core UI Regions (On-Trip Mode)","text":"Region Description Notes A. Live Map Real-time position, route polyline (current leg) Minimizes to picture-in-picture on scroll B. Up Next Card Photo, name, distance, ETA, key tags, Start / Navigate button Collapsible after arrival detection C. Nearby Petals Rail Swipeable suggestions within detour threshold (e.g. +10% time) Excludes current day's locked anchors D. Newly Discovered Banner Detected off-route or user-tapped unsaved Petal One-tap Save or Add to Trip (inserts into current day tail) E. Quick Actions Bar Swap Activity, Navigate (Google/Apple/Waze), Save for Later, Refresh Suggestions Hides when keyboard up F. Status &amp; Progress Strip Completed count / remaining, daylight/time warnings Simple icon + tooltip pattern"},{"location":"mockups/on-trip-mode-transition/#5-live-data-refresh-strategy","title":"5. Live Data &amp; Refresh Strategy","text":"Data Frequency Mechanism Notes Location 5\u201310s (dynamic) Geolocation API / native bridge Adaptive interval (slower when stationary) Route ETA On significant movement or segment change Provider API (rate-limited) Fallback to precomputed segment durations Nearby Petals Every 2 min or &gt;300m deviation Geo-filtered hybrid search + tag weighting Cache window 2\u20135 min Weather Alerts (optional) 30 min Third-party weather API Show only impactful alerts"},{"location":"mockups/on-trip-mode-transition/#6-personalization-suggestion-logic","title":"6. Personalization &amp; Suggestion Logic","text":"<p>Algorithm (simplified):</p> <ol> <li>Base retrieval: geo radius (dynamic by travel mode) + profile favorite_tags.</li> <li>Filter out already scheduled petals + recently dismissed.</li> <li>Diversify by tag cluster if top results homogenous &gt;60%.</li> <li>Apply novelty boost for petals similar to discovered but unsaved.</li> <li>Rank by composite: <code>0.5 * relevance + 0.2 * proximity_score + 0.2 * novelty + 0.1 * popularity</code>.</li> </ol>"},{"location":"mockups/on-trip-mode-transition/#7-telemetry-events","title":"7. Telemetry Events","text":"Event Payload Example ontrip_view { tripId, userId, dayIndex, mode:\"drive\" } ontrip_nearby_refresh { tripId, count, radiusMeters } ontrip_navigate_launch { tripId, provider:\"google\", segmentId } ontrip_discovered_show { tripId, petalId } ontrip_discovered_save { tripId, petalId } ontrip_swap_invoke { tripId, fromPetal, toPetal } ontrip_upnext_arrival { tripId, petalId, driftSeconds } ontrip_feedback_prompt { tripId, timing:\"end_of_day\" }"},{"location":"mockups/on-trip-mode-transition/#8-edge-cases","title":"8. Edge Cases","text":"Scenario Handling Offline mid-route Preserve last route polyline + Up Next details; disable refresh; queue saves GPS drift / low accuracy Show accuracy ring; delay arrival detection until stable No nearby petals Expand radius once; then show \"Enjoy the journey\" placeholder Excess suggestions churn Debounce refresh; diff highlight only net-new cards Arrival detection failure Manual \"Mark Arrived\" button reveals after ETA + threshold"},{"location":"mockups/on-trip-mode-transition/#9-accessibility","title":"9. Accessibility","text":"<ul> <li>Up Next card structured as landmark with heading for next destination.</li> <li>Nearby rail: list semantics + roving tabindex for swipeable cards.</li> <li>High-contrast map overlay icons; avoid color-only encoding for status.</li> <li>Motion-reduced mode: disable map auto-pan, provide textual distance updates.</li> </ul>"},{"location":"mockups/on-trip-mode-transition/#10-security-privacy","title":"10. Security &amp; Privacy","text":"Concern Mitigation Continuous location exposure Local-only; server gets coarse region unless user opts in to live share Sensitive companion info in logs Exclude companion tags from telemetry payloads Hallucinated dynamic suggestions Source annotations + retrieval ID hash stored for audit"},{"location":"mockups/on-trip-mode-transition/#11-future-enhancements","title":"11. Future Enhancements","text":"<ul> <li>Live collaborative markers (friends en route).</li> <li>Energy / battery-aware suggestion filtering (e-bike range).</li> <li>Predictive prefetch of likely next 2 segments for offline resilience.</li> <li>Passive learning of detour tolerance to tune proximity scoring.</li> </ul> <p>Figure 11 added: 2025-09-05 (asset <code>on-trip-mode-mobile.png</code>).</p> <p>Cross-links: <code>trip-in-progress.md</code>, <code>navigation-picker.md</code>, <code>user-dashboard.md</code>, <code>petal_schema.md</code>.</p>"},{"location":"mockups/search-refinement/","title":"Search Refinement Mockup","text":"<p> Figure 1. Divergent results view prompting the user to refine an overly broad weekend trip query.</p>"},{"location":"mockups/search-refinement/#scenario-broad-search-results","title":"Scenario: Broad Search Results","text":"<p>When a user\u2019s search prompt is too broad, BloomTrip provides diverging trip ideas and suggests refining the search further.</p>"},{"location":"mockups/search-refinement/#mockup","title":"Mockup","text":""},{"location":"mockups/search-refinement/#search-results","title":"Search Results","text":"<p> Figure 2. Mobile variant showing stacked trip idea cards; refinement CTA remains visible below list.</p> <p>Here are a few options based on your search:</p> <ol> <li>Campervan Getaway</li> <li>Take your camper for a scenic lakeside drive and mountain views.</li> <li> <p>[Choose this trip]</p> </li> <li> <p>Biking in the Forest</p> </li> <li>Ride under the shady canopy of a forest close to Bucharest.</li> <li> <p>[Choose this trip]</p> </li> <li> <p>Family Beach Trip</p> </li> <li>Enjoy some sun, sand, and family time on the Black Sea.</li> <li> <p>[Choose this trip]</p> </li> <li> <p>City Culture Tour</p> </li> <li>Discover museums, landmarks, and caf\u00e9 culture in the capital.</li> <li>[Choose this trip]</li> </ol>"},{"location":"mockups/search-refinement/#refinement-suggestions","title":"Refinement Suggestions","text":"<p>To refine your search, consider adding more details about: - Interests (e.g., biking, hiking, cultural tours) - Location (e.g., nearby cities, specific regions) - Companions (e.g., family, friends, pets)</p>"},{"location":"mockups/search-refinement/#after-choosing-a-trip","title":"After Choosing a Trip","text":""},{"location":"mockups/search-refinement/#trip-details-page","title":"Trip Details Page","text":"<ul> <li>Hero Image: Showcase the destination/activity.</li> <li>Why It\u2019s a Match: Display weather, distance, and profile tags (e.g., \ud83d\udeb2 E\u2011bikes \u2022 \ud83c\udf32 Nature \u2022 \ud83d\ude90 Camper).</li> <li>Day-by-Day Itinerary: Include times, activities, and optional swaps.</li> <li>Interactive Map: Plot all stops with custom BloomTrip icons.</li> </ul>"},{"location":"mockups/search-refinement/#personalization-options","title":"Personalization Options","text":"<ul> <li>Swap Activity: Replace a hike with a museum or a long ride with a shorter loop.</li> <li>Adjust Duration: Stretch a 1\u2011day trip into a 2\u2011day trip or vice versa.</li> <li>Add Companions: Tweak suggestions for kids, pets, or extra friends.</li> <li>Budget Filter: See options that fit a spending range.</li> </ul>"},{"location":"mockups/search-refinement/#logistics-resources","title":"Logistics &amp; Resources","text":"<ul> <li>Driving directions (Google/Bing Maps link).</li> <li>E\u2011bike charging points, campervan parking, and food stops.</li> <li>Weather forecast for each day.</li> <li>Links to source content (e.g., Komoot route, local event page).</li> </ul>"},{"location":"mockups/search-refinement/#save-share","title":"Save &amp; Share","text":"<ul> <li>Save to My Trips: Add to the user\u2019s profile for later.</li> <li>Share: Send a link to friends/family with the full itinerary.</li> <li>Export: Download as a PDF or sync to a calendar.</li> </ul>"},{"location":"mockups/search-refinement/#feedback-loop","title":"Feedback Loop","text":"<p>After the trip, users can: - Rate each activity. - Mark favorites. - Mute things they didn\u2019t enjoy.</p> <p>This feedback improves future recommendations.</p>"},{"location":"mockups/trip-builder-start/","title":"Trip Builder Start Screen (Entry Point Selector)","text":"<p> Figure 12. Trip Builder Start Screen (Mobile): single-column hero prompt with vertically stacked entry tiles and horizontal Quick Starts rail for rapid itinerary seeding.</p>"},{"location":"mockups/trip-builder-start/#1-purpose","title":"1. Purpose","text":"<p>Remove friction at the very beginning of planning by letting the user begin from any \"spark\" (promo, saved, recommendation, theme) and immediately preview a scaffolded Day 1.</p>"},{"location":"mockups/trip-builder-start/#2-hero-prompt","title":"2. Hero Prompt","text":"<p>Primary text: \u201cWhere shall we begin, Dragos?\u201d Subtext: Pick a starting point \u2014 I\u2019ll build the rest for you.</p> <p>Behavior: fades once a starting tile is chosen; replaced by compact trip title editor.</p>"},{"location":"mockups/trip-builder-start/#3-entry-tiles","title":"3. Entry Tiles","text":"Tile Source Default Content Tap Outcome Notes From a Promo Seasonal / trending campaign (e.g. \ud83c\udf42 Autumn Festival in D\u0103ne\u0219ti) Hero image + season tag Seeds draft with promo petal as anchor, pre-fills date (next weekend) Pulls from curated promo feed From a Saved Petal UserProfile.saved_petals (recent / most-loved) Real photo + tags Draft trip with that petal as Day 1 Activity 1 Ranking by recent interaction weight From a Recommendation AI curated (preferences + season + region) Illustration / neutral scenic Generates 2\u20133 seed petals (cluster) RAG retrieval + diversity pass"},{"location":"mockups/trip-builder-start/#recommendation-generation-seed","title":"Recommendation Generation (Seed)","text":"<p>Steps: profile preference tag weights \u2192 hybrid search (region + seasonality) \u2192 cluster by tag set \u2192 pick top centroid + complementary diversity pair.</p>"},{"location":"mockups/trip-builder-start/#4-smart-suggestions-quick-starts-bar","title":"4. Smart Suggestions (Quick Starts Bar)","text":"<p>Horizontal chip / card rail (scrollable): examples: Family weekend near Bucharest, E\u2011bike loop + picnic, Water activities before autumn ends. Selecting a Quick Start executes a predefined filter/prompt template and opens the builder with initial retrieval set + provisional ordering.</p>"},{"location":"mockups/trip-builder-start/#5-instant-builder-preview-transition","title":"5. Instant Builder Preview Transition","text":"<p>On selection: 1. Overlay spinner (&lt;400 ms target) while retrieving seed petals. 2. Slide left-to-right into standard Builder layout (Day 1 + map snippet + suggested add-ons side panel). 3. Show toast: \u201cDraft initialized \u2014 refine or add more petals.\u201d</p> <p>Esc / Back (within 3 s) returns to Start Screen preserving previous selection state.</p>"},{"location":"mockups/trip-builder-start/#6-suggested-addons-panel","title":"6. Suggested Add\u2011Ons Panel","text":"Source Logic Placement Nearby complementary Tag diversity vs seed anchor Top section Popular in region Popularity snapshot cache Middle Personal favorites Intersect favorite_tags Lower Seasonal expiring Season end proximity Highlighted badge"},{"location":"mockups/trip-builder-start/#7-merge-into-active-trip-while-traveling","title":"7. Merge Into Active Trip (While Traveling)","text":"<p>If user is already in On\u2011Trip Mode and launches a Promo: - Offer dialog: \u201cAdd to current trip or start new?\u201d - Choosing Add inserts promo petal into next available compatible time slot (conflict check: duration + travel delta) and regenerates local route polyline.</p>"},{"location":"mockups/trip-builder-start/#8-telemetry","title":"8. Telemetry","text":"Event Payload builder_start_view { userId } builder_tile_select { type:\"promo builder_quick_start_select { templateId } builder_seed_generate { count, durationMs } builder_merge_into_active { source:\"promo\", tripId }"},{"location":"mockups/trip-builder-start/#9-edge-cases","title":"9. Edge Cases","text":"Scenario Handling No saved petals Hide Saved tile; show an encouragement to save petals via search No promos active Replace Promo tile with dynamic recommendation cluster Recommendation retrieval empty Retry with relaxed geo radius; fallback to popular set Slow seed generation (&gt;2s) Show progressive skeleton (skeleton tiles)"},{"location":"mockups/trip-builder-start/#10-accessibility","title":"10. Accessibility","text":"<ul> <li>Tiles: role=button, aria-label includes tile type + primary petal name (if present).</li> <li>Quick Start rail: list semantics + focusable chips.</li> <li>Provide skip link directly to \u201cBuilder Preview\u201d after selection.</li> </ul>"},{"location":"mockups/trip-builder-start/#11-security-privacy","title":"11. Security &amp; Privacy","text":"Concern Mitigation Promo injecting restricted content Promo curation pipeline validates license_flags before publish Recommendation leakage of private tags Only surface tags already visible in profile preferences UI Seed hallucination All seed petals required to have source + source_id citations before acceptance"},{"location":"mockups/trip-builder-start/#12-future-enhancements","title":"12. Future Enhancements","text":"<ul> <li>Multi-select starting seeds (e.g. pick 2 saved petals to combine).</li> <li>Voice start: \u201cPlan a weekend nature trip.\u201d</li> <li>Recently abandoned drafts shortcut.</li> <li>A/B test tile ordering vs engagement.</li> </ul> <p>Figure 12 added: 2025-09-05 (image <code>trip-builder-start-mobile.png</code>).</p> <p>Cross-links: <code>user-dashboard.md</code>, <code>trip-in-progress.md</code>, <code>on-trip-mode-transition.md</code>, <code>petal_schema.md</code>.</p>"},{"location":"mockups/trip-feedback-survey/","title":"Post-Trip Feedback Survey (Lightweight Mobile Flow)","text":"<p> Figure 8. Post-Trip Feedback Survey collecting overall trip rating, per\u2011petal feedback, discovery input, and follow-up actions to enrich personalization + Popular Petals ranking signals.</p>"},{"location":"mockups/trip-feedback-survey/#1-purpose","title":"1. Purpose","text":"<p>Capture high-signal qualitative + structured feedback immediately after trip completion (or upon user returning to the app) while cognitive context is fresh\u2014fueling: personalization vector updates, Popular Petals scoring, quality moderation, and future trip suggestions.</p>"},{"location":"mockups/trip-feedback-survey/#2-entry-triggers","title":"2. Entry Triggers","text":"Trigger Condition Debounce Auto prompt Trip end date passed + user opens app (\u2264 48h) 1 per trip Manual User taps \u201cGive Feedback\u201d on trip detail None Reminder No response after 24h (push/email optional) Max 1 reminder"},{"location":"mockups/trip-feedback-survey/#3-survey-sections","title":"3. Survey Sections","text":"Section Elements Notes Header Trip title, supportive subtext Dynamic: \u201cweekend near {Region}\u201d Overall Rating Petal (1\u20135) or emoji scale Accepts skip (stores null) Recommend Toggle Yes / No Only shown if rating \u2265 3 or user opens details Activity (Per Petal) Mini card: name, rating 1\u20134, optional note Collapsible after rating chosen Discovery Prompt Open text + autosuggest petals Suggest list filters out already in library Final Actions Submit \u2022 Save Trip (if not) \u2022 Plan Follow-Up Follow-Up launches generation seed using feedback deltas"},{"location":"mockups/trip-feedback-survey/#4-data-model-submission-payload","title":"4. Data Model (Submission Payload)","text":"<pre><code>{\n  \"tripId\": \"forest_lake_weekend_2025_09_13\",\n  \"overall\": { \"rating\": 4, \"recommend\": true },\n  \"activities\": [\n    {\"segmentId\": \"seg_1\", \"petalId\": \"baneasa_forest\", \"rating\": 4, \"note\": \"Shady &amp; cool.\"},\n    {\"segmentId\": \"seg_2\", \"petalId\": \"snagov_lake\", \"rating\": 3, \"note\": \"Windy midday.\"}\n  ],\n  \"discoveries\": [\"hidden_boardwalk\", \"local_bakery\"],\n  \"freeformDiscovery\": \"Found a small lakeside kiosk with great lemonade.\",\n  \"clientMeta\": {\"device\": \"mobile\", \"lang\": \"en\"}\n}\n</code></pre>"},{"location":"mockups/trip-feedback-survey/#normalization","title":"Normalization","text":"<ul> <li><code>discoveries</code> list items resolved to Petal IDs via fuzzy match or created as candidate petals (pending moderation).</li> </ul>"},{"location":"mockups/trip-feedback-survey/#5-signal-derivation","title":"5. Signal Derivation","text":"Signal Source Uses petal_quality_score Per activity rating Ranking suppression / boost trip_satisfaction Overall rating Personalization weight shift recommend_flag Recommend toggle Social proof metrics discovery_yield Count of new discoveries User explorer persona weighting friction_flag Notes containing patterns (\"muddy\", \"closed\") Data freshness / POI status review"},{"location":"mockups/trip-feedback-survey/#6-telemetry-events","title":"6. Telemetry Events","text":"Event Payload Example feedback_view {tripId, activities:7} feedback_rate_trip {tripId, rating:4} feedback_rate_petal {tripId, petalId:\"baneasa_forest\", rating:3} feedback_discovery_add {tripId, candidate:\"hidden_boardwalk\"} feedback_submit {tripId, overall:4, activitiesRated:6} feedback_followup_generate {tripId, seed:\"follow_up\"}"},{"location":"mockups/trip-feedback-survey/#7-ranking-personalization-impact","title":"7. Ranking &amp; Personalization Impact","text":"Component Update Logic Popular Petals Increment weighted counters (recent ratings decay exponentially) User Vector Fine-tune interest dimensions (e.g., water, forest, cultural) based on high-rated petals Negative Signals Down-weight low-rated categories in next generation candidate pool Cold Start Aid Aggregated anonymous averages inform baseline priors"},{"location":"mockups/trip-feedback-survey/#8-privacy-compliance","title":"8. Privacy &amp; Compliance","text":"<ul> <li>Freeform notes passed through mild PII scrub (emails, phone numbers masked).</li> <li>Discovery submissions flagged for moderation before surfacing publicly.</li> <li>User can delete feedback (endpoint <code>DELETE /api/trips/{id}/feedback</code>).</li> </ul>"},{"location":"mockups/trip-feedback-survey/#9-ux-interaction-details","title":"9. UX Interaction Details","text":"Pattern Description Progressive Disclosure Only first 3 activities expanded; others lazy-expand on scroll Skip Friendly \u201cSkip for now\u201d returns to trip view; keeps reminder eligibility Micro Animations Petal rating selection pulses \u00b15% scale Optimistic Submit UI disables controls, shows inline success check \u2714"},{"location":"mockups/trip-feedback-survey/#10-accessibility","title":"10. Accessibility","text":"<ul> <li>Ratings group uses radiogroup semantics with clear aria-labels.</li> <li>Notes text areas support dictation / screen reader hints.</li> <li>Focus order: header \u2192 overall rating \u2192 per-activity groups \u2192 discovery prompt \u2192 actions.</li> </ul>"},{"location":"mockups/trip-feedback-survey/#11-error-handling","title":"11. Error Handling","text":"Scenario Handling Network fail on submit Queue payload locally (IndexedDB) retry w/ backoff Partial ratings only Accept; missing ratings omitted (null stored) Discovery unmatched Create tentative candidate (status=<code>pending</code>) Duplicate submit Idempotency key hash of (tripId + userId) prevents double ingest"},{"location":"mockups/trip-feedback-survey/#12-future-enhancements","title":"12. Future Enhancements","text":"<ul> <li>Sentiment analysis on notes \u2192 adaptive clarification prompt.</li> <li>Inline photo attachment for activity evidence.</li> <li>\u201cAuto plan follow-up\u201d wizard seeding delta preferences (e.g., more water activities next time).</li> </ul> <p>Figure 8 added (image pending upload as <code>trip-feedback-survey.png</code>).</p> <p>Cross-links: <code>trip-in-progress.md</code>, <code>itinerary-refinement-detail.md</code>, <code>navigation-picker.md</code></p>"},{"location":"mockups/trip-in-progress/","title":"Trip In Progress View (Pre-Commit Flex State)","text":"<p> Figure 6. Trip In Progress view showing a nearly finalized weekend plan: day-by-day cards, interactive route map, Petals rails (Saved &amp; Popular), AI refinement suggestions, and a prominent Save Trip action before commit.</p>"},{"location":"mockups/trip-in-progress/#1-purpose","title":"1. Purpose","text":"<p>Bridge the gap between active refinement and a committed itinerary. The user perceives the plan as \u201calmost done\u201d yet still malleable for micro-optimizations (timing, insertion, swaps) before locking and sharing.</p>"},{"location":"mockups/trip-in-progress/#2-key-ui-regions","title":"2. Key UI Regions","text":"Region Description Notes A. Trip Header Title, date window (editable pre-commit), profile match tags Shows match confidence + weather band summary B. Day Column(s) Ordered day cards with segment blocks Inline edit for time &amp; duration still enabled C. Live Map Route polyline + markers with semantic icons Auto-updates on Petal insertion or swap D. Petals Rail (Saved) User\u2019s previously saved activities Filter + search + drag source E. Petals Rail (Popular) Community-surfaced high-engagement petals Ranked by recency * popularity score F. Smart Suggestions Contextual AI improvement chips Each chip triggers a delta retrieval/refine G. Commit Bar Save Trip, Share (disabled until saved), Export Save transitions to immutable baseline state H. Activity Insight Hover Quick reason + provenance tooltip Pulled from original generation + RAG citations"},{"location":"mockups/trip-in-progress/#3-state-model","title":"3. State Model","text":"State Editable? Map Sync Sharing Notes InProgress YES (segments, timing, companions) Real-time Disabled Default after choosing a trip Saving Locked (optimistic) Paused until success Disabled Shows spinner on Commit Bar Committed NO (structural); notes still editable Stable snapshot + version tag Enabled Version = v1 baseline Collaborative (future) Limited (suggestion mode) Real-time Link-based Pending share feature"},{"location":"mockups/trip-in-progress/#4-save-trip-flow","title":"4. Save Trip Flow","text":"<ol> <li>User clicks Save Trip.</li> <li>Frontend assembles normalized itinerary JSON (segments, ordering, POI references, computed aggregates: totalDriveMin, totalRideMin, elevationGain, tag frequencies).</li> <li>POST <code>/api/trips</code> \u2192 returns <code>tripId</code> + <code>version=1</code>.</li> <li>UI transitions to Committed state; Share/Export buttons enable; delta refinement actions reduce (swap &amp; insert now open a \u201cCreate revision?\u201d prompt).</li> </ol>"},{"location":"mockups/trip-in-progress/#idempotency","title":"Idempotency","text":"<p>Client sends a <code>clientDraftId</code> to avoid duplicate saves if network retries.</p>"},{"location":"mockups/trip-in-progress/#5-petals-integration","title":"5. Petals Integration","text":"Aspect Behavior Saved Petals User-curated set (manual saves + post-trip favorites) Popular Petals Aggregated by region + activity tag (rolling 30d window) Ranking Signals insert_count, save_count, completion_rate, dwell_ms, implicit boosts (matching user profile tags) Drag &amp; Drop Shares mechanics defined in Figure 5 (Refinement Detail) Conflict Check Pre-drop cost: added drive mins + daylight window feasibility"},{"location":"mockups/trip-in-progress/#6-ai-suggestion-logic-pre-commit","title":"6. AI Suggestion Logic (Pre-Commit)","text":"Trigger Example Chip Scope Missing meal anchor \"Add a scenic lunch stop\" Day window (midday slot) Overloaded afternoon \"Shorten final ride before sunset\" Affected segments only Weak diversity \"Insert a cultural break\" Gap between long homogeneous activities High idle gap \"Fill early evening with light activity\" Gap prompt"},{"location":"mockups/trip-in-progress/#7-telemetry-incremental-to-refinement-view","title":"7. Telemetry (Incremental to Refinement View)","text":"Event Payload trip_inprogress_view {tripId, userId, entrySource:\"refinement|resume\"} trip_save_invoke {tripId, draftHash, segmentCount} trip_save_success {tripId, version, latencyMs} trip_save_error {tripId, errorCode} petal_list_scroll {tripId, list:\"saved|popular\", scrollDepthPct} suggestion_chip_show {tripId, chipType}"},{"location":"mockups/trip-in-progress/#8-delta-regeneration-constraints-vs-pre-commit","title":"8. Delta Regeneration Constraints vs Pre-Commit","text":"<ul> <li>Hard cap on concurrent pending delta tasks: 2</li> <li>If user tries a third: toast \u201cFinish pending adjustments first.\u201d</li> <li>Prevent full itinerary regeneration unless user explicitly clicks \u201cRebuild day\u201d.</li> </ul>"},{"location":"mockups/trip-in-progress/#9-accessibility","title":"9. Accessibility","text":"<ul> <li>Distinct ARIA landmarks for Day List, Petals Rails, Suggestion Panel.</li> <li>Drag &amp; drop alternative via: Select Petal \u2192 Choose Insertion Slot dialog.</li> <li>Snackbar announcements on save success/failure.</li> </ul>"},{"location":"mockups/trip-in-progress/#10-post-commit-transition-preview","title":"10. Post-Commit Transition (Preview)","text":"<p>After commit: new doc (future) \u201cShare &amp; Collaborate\u201d will define: invite links, suggestion mode, revision diffs (v1 \u2192 v2), and annotation layer for proposed changes.</p> <p>Figure 6 added: 2025-09-05</p>"},{"location":"mockups/user-dashboard/","title":"User Dashboard (Personal Travel Hub)","text":"<p> Figure 10a. Desktop User Dashboard: full-width layout with horizontal trip carousel, multi-column saved petals grid, seasonal rails, and feedback impact panel.</p> <p> Figure 10b. Mobile User Dashboard: condensed thumb-first stack prioritizing next actions (navigate, add petal, continue planning) and swipeable rails.</p> <p> Figure 10. Legacy composite dashboard mock retained for historical reference (desktop/mobile supersede). </p>"},{"location":"mockups/user-dashboard/#1-purpose","title":"1. Purpose","text":"<p>Provide a personalized, low-latency landing surface that answers: \"What should I do next?\" while showcasing progress (upcoming trips) and discovery (seasonal/popular petals) aligned with profile preferences.</p>"},{"location":"mockups/user-dashboard/#2-top-layout-structure-unified-concept","title":"2. Top Layout Structure (Unified Concept)","text":"Zone Description Primary Actions Data Sources Greeting &amp; Quick Actions Personalized welcome (\"Good morning, Dragos \ud83c\udf1e \u2014 ready for your next weekend escape?\") + time-of-day context Plan New Trip, Saved Petals, Upcoming Trips, Feedback &amp; History UserProfile + time-of-day heuristic Upcoming Trips Cards (desktop: horizontal carousel; mobile: single primary + pager dots) with name, dates, status, countdown, navigate button Open Trip, Navigate, Edit Trip Schema, cached travel metrics Saved Petals Library Filter chips (Nature, Family, Water, E\u2011bikes, Popular Nearby) + grid/list (responsive) + newly discovered highlight Add to Trip, Remove Save, Open Detail Petal Schema, saved_petals, discovered_petals Seasonal &amp; Popular Suggestions Curated rails (autumn festivals, e\u2011bike loops, water activities) blended with profile preferences View Petal, Add to Trip Popularity cache + preference weights + seasonality Feedback &amp; History Recent trips recap links, ratings distribution, \"Your impact\" RAG summary Open Recap, Rate Missed Petals Trip feedback, petal_feedback, popularity deltas Notifications &amp; Nudges Contextual actionable prompts (events, proximity, expiring seasonal items) Accept (add), Dismiss Rules engine (events + geo + calendar)"},{"location":"mockups/user-dashboard/#3-core-component-definitions","title":"3. Core Component Definitions","text":"Component Fields / Elements Notes Quick Action Tile icon, label, hotkey, aria-label Large hit area (min 44px) Trip Card cover_image, title, date_range, status_badge, countdown, navigate_btn Countdown if start_date &gt; now Petal Tile thumbnail, name, tags (max 3), add_to_trip_btn, new_badge New badge for discovered within last trip session Suggestion Card emoji/icon, title, reason_tag (e.g. \"seasonal\"), add_btn Explanation improves trust Ratings Summary avg_rating, top_tag, total_reviews Derived nightly cached aggregate Impact Banner text_dynamic, influenced_count Generated via RAG summary template Notification Item message, cta_label, dismiss Distinct icon per rule category"},{"location":"mockups/user-dashboard/#4-data-query-strategy","title":"4. Data &amp; Query Strategy","text":"<ul> <li>Saved petals: single batched lookup (IDs \u2192 petals) with partial projection.</li> <li>Upcoming trips: limit to next 3 sorted by start_date; prefetch active trip details.</li> <li>Seasonal suggestions: Redis key <code>popular:petals:{region}:{season}</code> + personalization rerank.</li> <li>Impact narrative: RAG template combining (petal_feedback deltas + popularity shifts).</li> </ul>"},{"location":"mockups/user-dashboard/#example-impact-narrative-prompt-system-instruction-excerpt","title":"Example Impact Narrative Prompt (System Instruction Excerpt)","text":"<p>\"Generate a concise (&lt;= 28 words) positive summary of how the user's recent ratings influenced popularity. Use concrete category or tag names. Avoid exaggeration.\"</p>"},{"location":"mockups/user-dashboard/#5-caching-performance","title":"5. Caching &amp; Performance","text":"Data Slice Cache Layer TTL Invalidation Saved Petal IDs profile core cache 5m On add/remove save Petal Tile Projection retrieval/petal object 10m Petal freshness trigger Seasonal Rail popularity snapshot 30m Popularity recompute job Impact Narrative semantic response cache 2h New feedback submission Upcoming Trips Summary trip read model 10m Trip mutation"},{"location":"mockups/user-dashboard/#6-personalization-rag-integration","title":"6. Personalization &amp; RAG Integration","text":"<ul> <li>Seasonal rails filtered by region + seasonality + profile.favorite_tags.</li> <li>RAG summarizer generates \"Your impact\" and optional micro-suggestions (e.g., suggest rating missed petals).</li> <li>Diversification heuristic ensures at least one exploratory (non-overlapping tag set) suggestion if cluster homogeneity &gt; 60%.</li> </ul>"},{"location":"mockups/user-dashboard/#7-telemetry-events","title":"7. Telemetry Events","text":"Event Payload Fields (Example) dashboard_view { userId, savedCount, upcomingTrips, season:\"autumn\" } dashboard_click_quick_action { action:\"plan_trip\" } dashboard_trip_card_open { tripId, status } dashboard_navigate_launch { tripId, provider:\"google\" } dashboard_petal_add_to_trip { petalId, tripContext? } dashboard_suggestion_impression { petalId, rail:\"autumn_festivals\" } dashboard_feedback_banner_open { tripId } dashboard_notification_accept { ruleId } dashboard_notification_dismiss { ruleId }"},{"location":"mockups/user-dashboard/#8-edge-cases-fallbacks","title":"8. Edge Cases &amp; Fallbacks","text":"Scenario Handling No upcoming trips Show CTA card: \"Plan your next escape\" No saved petals Replace grid with onboarding tips (add via search) Low seasonal content Expand radius or fallback to popular evergreen petals Offline mode Serve last cached snapshot + disable actions needing network API latency spike Skeleton loaders + staggered fade-in Empty feedback history Invite to rate past trip(s) via recap prompt"},{"location":"mockups/user-dashboard/#9-accessibility","title":"9. Accessibility","text":"<ul> <li>All interactive tiles: 44x44 min, focus outline AA contrast.</li> <li>Landmark roles: header (greeting), main (content rails), complementary (feedback panel), region labels for carousels.</li> <li>Provide skip links to \"Saved Petals\" and \"Suggestions\" sections.</li> <li>ARIA live region for notifications insertion.</li> </ul>"},{"location":"mockups/user-dashboard/#10-security-privacy-notes","title":"10. Security &amp; Privacy Notes","text":"Concern Mitigation Exposure of private trip titles in shared device Obfuscate (\"Trip 1\") when privacy mode enabled Over-personalized notifications leaking companion info Avoid explicit companion names in banner text Feedback narrative hallucination Constrain prompt with numeric anchors (counts, rating deltas)"},{"location":"mockups/user-dashboard/#11-future-enhancements","title":"11. Future Enhancements","text":"<ul> <li>Collaborative activity feed (recent edits by collaborators).</li> <li>Inline trip quick-ref panel (next upcoming day's first 3 activities).</li> <li>A/B testing rail placements (engagement vs decision latency).</li> <li>Dynamic theming based on dominant seasonal palette.</li> </ul>"},{"location":"mockups/user-dashboard/#12-implementation-checklist","title":"12. Implementation Checklist","text":""},{"location":"mockups/user-dashboard/#13-mobile-adaptation-details","title":"13. Mobile Adaptation Details","text":"Aspect Desktop Mobile Quick Actions 4 tiles in a single row (wide) 2x2 grid or horizontal scroll row Upcoming Trips Multi-card carousel (peek of next) Single primary card + swipe/pager Saved Petals 3\u20134 columns grid 1\u20132 column adaptive; horizontal chip scroll Seasonal Rails Full-width with 4 visible cards Snap carousel (1.2 card width) Feedback Panel Right-side / lower section Collapsible accordion near bottom Notifications Inline right column or top bar badge Sticky drawer / slide-up sheet <p>Gestures (Mobile):</p> <ul> <li>Horizontal swipe: trip cards, seasonal rails, saved petals filters.</li> <li>Long-press petal: quick add/remove saved state.</li> <li>Swipe notification left: dismiss; right: accept (if additive action).</li> </ul> <p>Performance Considerations:</p> <ul> <li>Defer seasonal rails below fold (IntersectionObserver) to reduce initial payload.</li> <li>Use speculative prefetch for the most-likely next trip (based on imminence).</li> </ul>"},{"location":"mockups/user-dashboard/#14-tech-notes-expanded","title":"14. Tech Notes (Expanded)","text":"Concern Implementation Fast petal search/filter Azure AI Search hybrid; precomputed facet counts cached Image tagging &amp; translation Cognitive Services Vision + Translator queued enrichment on ingestion Review summarization Cognitive Services Language (summarization) -&gt; persisted summary field Seasonal suggestion generation RAG: popularity snapshot + profile tag weights + prompt template Impact narrative RAG with constrained numeric anchors (rating deltas, top tag) Caching tiers Redis: profile core, retrieval sets, popularity snapshot, semantic narrative Notification rules Event ingestion -&gt; lightweight rules engine (Functions) -&gt; queue -&gt; user feed store Latency target P95 &lt; 600 ms warm (excluding large image loads)"},{"location":"mockups/user-dashboard/#15-open-questions","title":"15. Open Questions","text":"<ul> <li>Should notifications unify with trip-specific alerts (single feed) or remain dashboard-scoped?</li> <li>Do we allow inline editing of trip title from card?</li> <li>How aggressive should exploratory suggestion diversification be (A/B)?</li> </ul> Item Status Quick action tile component Planned Trip carousel w/ countdown logic Planned Saved petals grid + filters Planned Seasonal rails retrieval + rerank Planned RAG impact summary endpoint Planned Notification rules engine Planned Telemetry ingestion mapping Planned Accessibility audit pass Planned <p>Figure 10 / 10a / 10b added: 2025-09-05 (assets: <code>dashboard.png</code>, <code>user-dashboard-desktop.png</code>, <code>user-dashboard-mobile.png</code>).</p> <p>Cross-links: <code>trip-in-progress.md</code>, <code>petal_schema.md</code>, <code>trip_schema.md</code>, <code>user_profile_schema.md</code>, <code>rag_pipeline.md</code>. Additional Link: See <code>on-trip-mode-transition.md</code> for the in-motion experience after commit / start.</p>"},{"location":"mockups/weekend-bucharest-ebike/","title":"Weekend Preview: Bucharest E\u2011Bike &amp; Camper Weekend (Sample Output)","text":"<p>Label (internal): example_itinerary_bucharest_ebike_2025_09_13</p>"},{"location":"mockups/weekend-bucharest-ebike/#header","title":"Header","text":"<p>BloomTrip \u2014 Your Weekend, Curated Weekend of: 13\u201314 September 2025 Profile match: \ud83d\udeb2 E\u2011bike enthusiast \u2022 \ud83c\udf32 Nature lover \u2022 \ud83c\udfd5 Camper\u2011friendly \u2022 \ud83d\udccd Based in Bucharest Radius: \u2264 2h drive</p>"},{"location":"mockups/weekend-bucharest-ebike/#why-youre-seeing-this","title":"Why You\u2019re Seeing This","text":"<p>Weather: Sunny, 24\u202f\u00b0C \u2014 ideal for cycling + light hiking Interests matched: E\u2011bikes, nature trails, short getaways Seasonal highlight: Early autumn foliage (forest + lakeside) Context signals: Weekend window, clear skies, moderate temps, low precipitation risk</p>"},{"location":"mockups/weekend-bucharest-ebike/#your-weekend-plan","title":"Your Weekend Plan","text":""},{"location":"mockups/weekend-bucharest-ebike/#day-1-saturday-forest-lakeside-ride","title":"Day 1 \u2014 Saturday: Forest &amp; Lakeside Ride","text":"<p>Morning B\u0103neasa Forest E\u2011Bike Loop (\u224825 km, easy\u2013moderate). Start near B\u0103neasa Residential Park and follow shaded mixed dirt / paved paths. Highlights: Birdsong, cool forest air, transitional foliage pockets. Coffee stop: Casa Alb\u0103 caf\u00e9 (outdoor seating, bike-friendly).</p> <p>Afternoon Transfer / ride to Snagov Lake (~40 min drive). Lakeside picnic near Snagov Monastery (flat grassy shore; partial shade). Optional: 1\u2011hour kayak rental (weather and vendor availability). Campervan parking: Snagov Camping (basic hookups).  </p> <p>Evening Sunset ride: Snagov \u2192 Moara Vl\u0103siei loop (~12 km, flat, scenic farm &amp; forest edge). Stay: Camper at Snagov Camping or local guesthouse (bike storage friendly).</p>"},{"location":"mockups/weekend-bucharest-ebike/#day-2-sunday-countryside-foothills","title":"Day 2 \u2014 Sunday: Countryside &amp; Foothills","text":"<p>Morning Early drive (~1h30) to Sinaia foothills trailhead. Route: Sinaia \u2192 Poiana St\u00e2nii \u2192 return. Elevation gain: ~300 m; surfaces: gravel + packed soil; views of Bucegi range. Photo stop: Overlook clearing before descent.</p> <p>Afternoon Return via Moara Vl\u0103siei for countryside inn lunch (local produce). Optional: Short recovery spin on forest spur (~6 km) if energy remains. Drive back to Bucharest (\u22641h).</p>"},{"location":"mockups/weekend-bucharest-ebike/#logistics-stats","title":"Logistics &amp; Stats","text":"Aspect Detail Total Ride Distance ~60\u201370 km over two days Max Drive Segment ~1h30 (Bucharest \u2192 Sinaia foothills) Camper Overnight Snagov Camping (primary) / lawful wild spots (check local regs) E\u2011Bike Charging Snagov guesthouses, Sinaia caf\u00e9s (ask permission) Surfaces Forest dirt, packed gravel, light pavement, lakeside paths Gear Highlights Helmet, spare battery, lightweight lock, mid-layer for morning in foothills"},{"location":"mockups/weekend-bucharest-ebike/#suggested-packing","title":"Suggested Packing","text":"<ul> <li>E\u2011bike + spare battery</li> <li>Weather layer (cool morning / warmer afternoon)</li> <li>Hydration (2 bottles) + electrolytes</li> <li>Trail snacks (nuts, dried fruit)</li> <li>Compact repair kit (multitool, plugs, mini pump)</li> <li>Power bank (phone + GPS)</li> </ul>"},{"location":"mockups/weekend-bucharest-ebike/#swap-adjust-options-dynamic-ui-ideas","title":"Swap / Adjust Options (Dynamic UI Ideas)","text":"If user wants\u2026 Offer swap More elevation Extend Poiana St\u00e2nii loop + ridge spur (+12 km) Shorter Day 2 Replace Sinaia loop with Moara Vl\u0103siei forest wander (~18 km flat) Non\u2011cycling afternoon Kayak + lakeside reading block at Snagov Rain risk Indoor e\u2011bike session + museum alternative in Sinaia (Pele\u0219 area)"},{"location":"mockups/weekend-bucharest-ebike/#feedback-anchors-app-instrumentation","title":"Feedback Anchors (App Instrumentation)","text":"<ul> <li>Trip card group ID: <code>wknd_2025_09_13_RO_Bucharest_outdoor_mix</code> </li> <li>Each segment (Forest Loop, Snagov Lakeside, Sinaia Loop) gets independent Save / Boost / Mute telemetry.</li> </ul>"},{"location":"mockups/weekend-bucharest-ebike/#source-hints-would-be-cited-in-app","title":"Source Hints (Would Be Cited In-App)","text":"<ul> <li>Local MTB forum trail thread (B\u0103neasa conditions)</li> <li>Public recreation dataset (Snagov amenities)</li> <li>Weather API (forecast snapshot at generation time)</li> <li>User profile embeddings (interests: e\u2011bike, nature, camper)</li> </ul>"},{"location":"mockups/weekend-bucharest-ebike/#ui-representation-concept","title":"UI Representation (Concept)","text":"<p>Each section is a \u201cTrip Card\u201d component: <code>&lt;TripCard title=\"B\u0103neasa Forest Loop\" distance=\"25 km\" difficulty=\"Easy\u2011Moderate\" badges={['E\u2011Bike','Forest','Shaded']} rationale=\"Matches your e\u2011bike + forest preferences and current mild temperature window.\" /&gt;</code></p> <p>Interactive actions per card: [Save] [Boost Similar] [Mute] [Swap] [Explain]</p>"},{"location":"mockups/weekend-bucharest-ebike/#potential-personalization-tokens","title":"Potential Personalization Tokens","text":"Token Example Value Use user.home_base Bucharest Travel time filtering user.radius_hours 2 Limit day-trip candidates user.interests [\"e-bike\",\"nature\",\"camper\"] Retrieval filters + embedding weighting env.weather_window Sunny_24C Boost outdoor trails season.phase EarlyAutumn Foliage &amp; shoulder-season suggestions"},{"location":"mockups/weekend-bucharest-ebike/#future-enhancements","title":"Future Enhancements","text":"<ul> <li>Inline \u201cbattery management\u201d tip if total elevation &gt; threshold</li> <li>Add micro air quality advisory (forest fire / pollen spikes)</li> <li>Dynamic calorie estimate &amp; recovery suggestion</li> <li>Optional group-share link (collaboration phase)</li> </ul>"},{"location":"mockups/weekend-bucharest-ebike/#disclaimer","title":"Disclaimer","text":"<p>Routes and access points should be verified day-of (trail maintenance, private access changes). Always follow local regulations for camping and protected areas.</p> <p>Last updated: 2025-09-05</p>"},{"location":"mockups/images/","title":"Mockup Images","text":"<p>Place exported PNG/JPEG mockup files here. Referenced by markdown docs.</p> <p>Expected filenames (add real images with these names): - search-refinement-screen.png - itinerary-map-page.png - divergent-results-mobile.png - itinerary-day-detail.png</p> <p>After adding binary images, MkDocs will include them automatically; ensure relative paths in markdown: <code>![Alt text](images/filename.png)</code>.</p>"},{"location":"operations/deployment/","title":"Deployment","text":"<p>Deployment guidance will evolve with the codebase. Current draft assumptions.</p>"},{"location":"operations/deployment/#1-environments","title":"1. Environments","text":"Env Purpose Notes dev Rapid iteration / feature spikes May use lighter SKUs staging Pre-prod validation, load tests Mirrors prod config flags prod Live traffic Observability SLO enforced"},{"location":"operations/deployment/#2-infrastructure-as-code","title":"2. Infrastructure as Code","text":"<p>Prefer Bicep modules (or Terraform if multi-cloud required). Core stacks: network/base, data (SQL, Storage, Search, Redis), app (Functions/App Service), ml (AML workspace + endpoint).</p>"},{"location":"operations/deployment/#3-secrets-key-vault","title":"3. Secrets &amp; Key Vault","text":"<p>All API keys, connection strings stored in Azure Key Vault; access via managed identity. Local dev uses <code>.env.local</code> (excluded from VCS).</p>"},{"location":"operations/deployment/#4-cicd-planned-flow","title":"4. CI/CD (Planned Flow)","text":"Step Action Lint Markdown + schema validation Test Unit / integration suites Build Containerize services (if present) Deploy staging Bicep deploy &amp; AML model update Smoke tests Basic health + endpoint contract checks Promote prod Manual approval gate"},{"location":"operations/deployment/#5-rollback-strategy","title":"5. Rollback Strategy","text":"<ul> <li>Keep previous container images &amp; AML model versions tagged.</li> <li>Fast revert: switch active AML deployment version + redeploy previous infra template if drift.</li> </ul>"},{"location":"operations/deployment/#6-release-strategy","title":"6. Release Strategy","text":"<p>Start with blue/green (staging acts as blue); graduate to canary (percentage routing via Front Door / APIM) when traffic justifies.</p> <p>Last updated: September 2025</p>"},{"location":"operations/monitoring/","title":"Monitoring &amp; Logging","text":"<p>This page will define observability standards for the platform.</p>"},{"location":"operations/monitoring/#1-key-metrics-draft","title":"1. Key Metrics (Draft)","text":"Category Metric Purpose Performance p95_recommendation_latency_ms User experience &amp; SLO tracking Retrieval cache_hit_ratio Cost + latency optimization Model tokens_per_request Cost forecasting Errors generation_error_rate Quality &amp; stability Infra function_cold_starts Tuning warm strategy"},{"location":"operations/monitoring/#2-dashboards","title":"2. Dashboards","text":"<ul> <li>Azure Monitor workbook: latency, error rates, cost overlay.</li> <li>App Insights dashboards: dependency durations (Search, OpenAI, Redis).</li> </ul>"},{"location":"operations/monitoring/#3-log-schema-correlation","title":"3. Log Schema / Correlation","text":"<p>Structured log fields: <code>timestamp</code>, <code>level</code>, <code>intent_id</code>, <code>request_id</code>, <code>profile_id_hash</code>, <code>stage</code>, <code>latency_ms</code>, <code>result_count</code>.</p>"},{"location":"operations/monitoring/#4-alert-rules-initial","title":"4. Alert Rules (Initial)","text":"Alert Condition Action High latency p95_recommendation_latency_ms &gt; 1500 for 5m Page / Slack channel Low cache hit cache_hit_ratio &lt; 40% for 30m Investigate retrieval filter drift Elevated errors generation_error_rate &gt; 5% Trigger rollback / inspect prompts"},{"location":"operations/monitoring/#5-tracing-strategy","title":"5. Tracing Strategy","text":"<p>Adopt OpenTelemetry SDK; propagate <code>traceparent</code> headers across API \u2192 retrieval \u2192 generation.</p> <p>Last updated: September 2025</p>"},{"location":"overrides/","title":"MkDocs Theme Overrides","text":"<p>This directory exists to satisfy <code>custom_dir: docs/overrides</code> in <code>mkdocs.yml</code>.</p> <p>Add Jinja2 templates or partials here to extend/override the Material theme (e.g. main.html, footer.html, logo, or extra macros).</p> <p>Currently empty aside from this note to prevent build errors.</p>"},{"location":"specs/api_endpoints/","title":"API Endpoints (Early Draft)","text":"<p>Base path likely: <code>/api/v1</code></p>"},{"location":"specs/api_endpoints/#proposed-routes","title":"Proposed Routes","text":""},{"location":"specs/api_endpoints/#health-meta","title":"Health &amp; Meta","text":"<p>GET /health GET /version</p>"},{"location":"specs/api_endpoints/#petals","title":"Petals","text":"<p>POST /petals GET /petals/{id} GET /petals?type=&amp;tag=&amp;limit=&amp;cursor= PUT /petals/{id} DELETE /petals/{id}</p>"},{"location":"specs/api_endpoints/#trips","title":"Trips","text":"<p>POST /trips (generate or create manual) GET /trips/{id} GET /trips?user_id=&amp;limit=&amp;cursor= PUT /trips/{id} DELETE /trips/{id}</p>"},{"location":"specs/api_endpoints/#user-profiles","title":"User Profiles","text":"<p>POST /users GET /users/{id} PATCH /users/{id}</p>"},{"location":"specs/api_endpoints/#retrieval-rag","title":"Retrieval / RAG","text":"<p>POST /retrieval/query POST /rag/generate POST /rag/explain</p>"},{"location":"specs/api_endpoints/#enrichment","title":"Enrichment","text":"<p>POST /enrichment/embeddings/batch POST /enrichment/classify</p>"},{"location":"specs/api_endpoints/#auth","title":"Auth","text":"<ul> <li>Likely token-based (JWT or OAuth2). TBD.</li> </ul>"},{"location":"specs/api_endpoints/#versioning-strategy","title":"Versioning Strategy","text":"<ul> <li>URL versioning + <code>X-API-Version</code> header for experimentation.</li> </ul>"},{"location":"specs/petal_schema/","title":"Petal Schema","text":"<p>Atomic, enriched, retrieval-optimized content unit powering discovery, itinerary generation, refinement and personalization.</p>"},{"location":"specs/petal_schema/#1-core-fields","title":"1. Core Fields","text":"Field Type Description Index Use Notes id string (GUID) Stable unique identifier key Generated server-side name string Human-friendly title searchable Min length 3 description string Canonical descriptive text (curated or AI assisted) searchable Sanitized &amp; citation enriched location geo-point Latitude/longitude filter (geo) Used for radius &amp; clustering region string Region / admin area slug filter, facetable Lowercased normalized tags string[] Descriptive facets (activity types, themes) searchable, filter, facetable Capped (&lt;=25) seasonality string[] Active seasons or months filter Values: months (\"jan\") or seasons duration string Human readable (e.g. \"1h 30m\") none Also parse to minutes int internally difficulty string Trail/effort rating filter Enum: easy accessibility string[] Accessibility/support flags filter e.g. wheelchair-friendly, pet-friendly media object[] Array of none Alt text required source string Origin provider filter E.g. tripadvisor, google_places, user source_id string External reference ID filter For rehydration / refresh license_flags string[] Usage constraints filter E.g. no-cache, attribution-required rating float Avg user rating (1\u20135) sortable 1 decimal precision review_count int Count of ratings/reviews sortable Non-negative status string visited missed newly-discovered last_updated datetime Freshness &amp; invalidation sortable ISO 8601 UTC"},{"location":"specs/petal_schema/#2-optional-enrichment-fields","title":"2. Optional / Enrichment Fields","text":"Field Type Description Index Use Notes embedding vector(float[]) OpenAI embedding vector Dimension depends on model (e.g., 1536) sentiment_score float From sentiment analysis (-1..1) sortable Nullable summary string AI short blurb for cards searchable Length &lt; 280 chars user_notes string[] (Scoped) user-specific notes none Not indexed globally popularity_score float Derived ranking score sortable Composite metric related_petals string[] Similar/complementary IDs none Drive suggestion rails"},{"location":"specs/petal_schema/#3-indexing-configuration-azure-ai-search","title":"3. Indexing Configuration (Azure AI Search)","text":"Category Fields Searchable name, description, summary, tags Filterable region, tags, seasonality, difficulty, accessibility, source, license_flags, status, rating, review_count, last_updated Sortable rating, review_count, popularity_score, last_updated, sentiment_score Facetable region, tags, seasonality, difficulty, accessibility, source Vector embedding Key id Suggester name, tags <p>Vector Search: HNSW (m=16, efConstruction=400, efSearch tuned 40\u201380). Hybrid queries combine BM25 + vector + optional semantic rank.</p>"},{"location":"specs/petal_schema/#4-validation-constraints","title":"4. Validation &amp; Constraints","text":"<ul> <li>Enforce max tag count (&lt;=25) &amp; length (&lt;=40 chars/tag)</li> <li>Strip HTML; allow safe markdown subset if needed (render pipeline sanitizes)</li> <li><code>rating</code> in [1.0,5.0]; <code>review_count</code> monotonic increasing</li> <li>All arrays deduplicated</li> <li>Geo: WGS84 lat (-90..90), lon (-180..180)</li> </ul>"},{"location":"specs/petal_schema/#5-lifecycle-invalidation","title":"5. Lifecycle &amp; Invalidation","text":"<p>Triggers for refresh: - Source delta (detected via ETag/hash) - License flag change - Season boundary (seasonality mismatch) - Low freshness window (e.g., &gt;30d general, &gt;7d events)</p>"},{"location":"specs/petal_schema/#6-caching-keys-examples","title":"6. Caching Keys (Examples)","text":"Purpose Pattern TTL Provider object provider:place:{source}:{source_id} 2h (respect TOS) Normalized petal petal:{id}:v1 6h Popular region list popular:petals:{region} 30m"},{"location":"specs/petal_schema/#7-rag-usage","title":"7. RAG Usage","text":"<ul> <li>Retrieval slices include: name, summary or truncated description, tags, seasonality, rating, region, distance bucket</li> <li>Always carry <code>source</code> + <code>source_id</code> for citation</li> <li>Use <code>related_petals</code> for diversification expansion if top results cluster too tightly</li> </ul>"},{"location":"specs/petal_schema/#8-open-questions-future","title":"8. Open Questions &amp; Future","text":"<ul> <li>Multi-locale content strategy (separate docs vs field variants?)</li> <li>Multi-vector fields (description vs tags) in later phase</li> <li>Versioning model (immutable history table) for audit</li> </ul> <p>See also: <code>trip_schema.md</code>, <code>user_profile_schema.md</code>, <code>../rag_pipeline.md</code></p>"},{"location":"specs/trip_schema/","title":"Trip Schema","text":"<p>Container for itinerary structure, collaborative edits, personalization context, and generation lineage.</p>"},{"location":"specs/trip_schema/#1-core-fields","title":"1. Core Fields","text":"Field Type Description Index Use Notes trip_id string (GUID) Unique identifier key Distinct from internal DB PK if needed title string Trip title searchable description string Optional overview/theme searchable start_date date Start date filter, sortable end_date date End date filter, sortable Must be &gt;= start_date location_center geo-point Center for retrieval radius filter (geo) created_by string Owner user id filter collaborators string[] Additional editors none Access control layer status string draft|in-progress|finalized|completed filter visibility string private|shared|public filter last_updated datetime Sync &amp; cache invalidation sortable"},{"location":"specs/trip_schema/#2-itinerary-structure","title":"2. Itinerary Structure","text":"Field Type Description days Day[] Ordered days"},{"location":"specs/trip_schema/#day","title":"Day","text":"Field Type Description date date Calendar date activities Activity[] Ordered / slotted items"},{"location":"specs/trip_schema/#activity","title":"Activity","text":"Field Type Description petal_id string Reference to petal time_slot string morning|midday|afternoon|evening|flex start_time? string Optional ISO local time end_time? string Optional notes string User notes or AI suggestion rationale status string planned|completed|skipped"},{"location":"specs/trip_schema/#3-preferences-snapshot","title":"3. Preferences Snapshot","text":"Field Type Description travel_mode string campervan|car|e-bike|walk|mixed companions string[] e.g. family, kids, dog tags string[] Thematic focus seasonality string Primary target season weather_forecast? object Snapshot at plan time"},{"location":"specs/trip_schema/#4-feedback-post-trip-signals","title":"4. Feedback &amp; Post-Trip Signals","text":"Field Type Description feedback object { rating:int(1..5), comment:string } overall discovered_petals string[] Added spontaneously missed_petals string[] Planned but not visited"},{"location":"specs/trip_schema/#5-derived-analytics","title":"5. Derived / Analytics","text":"Field Type Description popularity_score float Engagement weighting regeneration_count int Number of AI regenerations"},{"location":"specs/trip_schema/#6-rag-integration","title":"6. RAG Integration","text":"<ul> <li>Provide active day context (previous, current, next) for refinement prompts</li> <li>Track activity-level overrides to avoid model re-adding removed petals</li> <li>Use <code>discovered_petals</code> + <code>missed_petals</code> to seed make-up or follow-up trip suggestions</li> </ul>"},{"location":"specs/trip_schema/#7-caching-keys","title":"7. Caching Keys","text":"Purpose Pattern TTL Trip read model trip:{trip_id}:v1 10m Day segment trip:{trip_id}:day:{n} 5m Regeneration draft tripdraft:{trip_id}:{hash} 30m"},{"location":"specs/trip_schema/#8-versioning-collaboration","title":"8. Versioning &amp; Collaboration","text":"<ul> <li>Write-ahead log of itinerary mutations (append-only) for audit &amp; rollback</li> <li>Optimistic concurrency token per trip (<code>etag</code>)</li> <li>Optional real-time channel (WebSocket/SignalR) broadcasting diff patches</li> </ul>"},{"location":"specs/trip_schema/#9-open-questions-future","title":"9. Open Questions / Future","text":"<ul> <li>Locking model for simultaneous same-day edits?</li> <li>Activity conflict detection (overlapping durations)</li> </ul> <p>See also: <code>petal_schema.md</code>, <code>user_profile_schema.md</code>, <code>../rag_pipeline.md</code></p>"},{"location":"specs/user_profile_schema/","title":"User Profile Schema","text":"<p>Personalization anchor capturing stable preferences, dynamic signals, and feedback loops to influence retrieval, ranking, and generation.</p>"},{"location":"specs/user_profile_schema/#1-core-identity","title":"1. Core Identity","text":"Field Type Description user_id string (GUID) Unique identifier name string Display name email string Login / notifications language string Preferred UI language (BCP 47) location string Home base / default region created_at datetime Account creation last_active datetime For engagement &amp; churn signals"},{"location":"specs/user_profile_schema/#2-saved-content","title":"2. Saved Content","text":"Field Type Description saved_petals string[] Bookmarked petals saved_trips string[] Stored trip IDs favorite_tags string[] Preference weighting recent_searches string[] Last N queries (rotating) discovered_petals string[] Found during trips missed_petals string[] Planned but skipped"},{"location":"specs/user_profile_schema/#3-preferences","title":"3. Preferences","text":"Field Type Description travel_modes string[] campervan, bike, car, walk companions string[] kids, partner, dog, solo seasonality_pref string[] Preferred seasons accessibility_needs string[] e.g. wheelchair-friendly notification_opt_in boolean Messaging enable"},{"location":"specs/user_profile_schema/#4-feedback-ratings","title":"4. Feedback &amp; Ratings","text":"Field Type Description petal_feedback object[] { petal_id, rating(1..5), comment } trip_feedback object[] { trip_id, rating(1..5), comment } suggested_petals object[] { name, geo?, tags?, note } user ideas"},{"location":"specs/user_profile_schema/#5-personalization-signals","title":"5. Personalization Signals","text":"Signal Source Usage favorite_tags explicit saves Boost matching petals discovered_petals trip logs Expand exploration diversity missed_petals trip logs Make-up trip prompts petal_feedback.rating feedback form Ranking training label seasonality_pref profile Seasonal biasing"},{"location":"specs/user_profile_schema/#6-embeddings-privacy","title":"6. Embeddings &amp; Privacy","text":"<ul> <li>Optional <code>preference_embedding</code> built from interaction vectors</li> <li>Store only hashed or truncated recent searches beyond N=20 if privacy requirement emerges</li> <li>PII minimization: separate secure store if regulatory scope expands</li> </ul>"},{"location":"specs/user_profile_schema/#7-caching-keys","title":"7. Caching Keys","text":"Purpose Pattern TTL Profile core profile:{user_id}:v1 5m Preference vector profile:vec:{user_id}:v1 30m"},{"location":"specs/user_profile_schema/#8-rag-use-cases","title":"8. RAG Use Cases","text":"<ul> <li>Inject top preference tags + companions into prompt context summary</li> <li>Use missed/discovered petals to bias retrieval diversification</li> <li>Use feedback sentiment to prune low-quality petals over time</li> </ul>"},{"location":"specs/user_profile_schema/#9-future-considerations","title":"9. Future Considerations","text":"<ul> <li>Federated learning for personalization without exporting raw events</li> <li>Time-decay weighting of favorites</li> <li>Multi-tenant privacy partitioning</li> </ul> <p>See also: <code>petal_schema.md</code>, <code>trip_schema.md</code>, <code>../rag_pipeline.md</code></p>"}]}