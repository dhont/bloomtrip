<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1180" height="620" viewBox="0 0 1180 620" role="img" aria-label="RAG pipeline flow diagram">
 <style>
  .stage{fill:#ffffff;stroke:#1e88e5;stroke-width:1.4;font:12px 'Segoe UI',Arial,sans-serif}
  .decision{fill:#fff3e0;stroke:#fb8c00;stroke-width:1.4}
  .cache{fill:#fdf6e3;stroke:#d2b48c;stroke-width:1.2}
  .store{fill:#e3f2fd;stroke:#64b5f6;stroke-width:1.2}
  .title{font:16px 'Segoe UI Semibold',Arial,sans-serif}
  text{fill:#222;font:11px 'Segoe UI',Arial,sans-serif}
  .group{fill:none;stroke:#888;stroke-dasharray:6 4;stroke-width:1.2}
  marker#arrow{markerWidth:8;markerHeight:8;refX:7;refY:3;orient=auto;markerUnits:strokeWidth}
  path.flow{stroke:#555;stroke-width:1.3;fill:none;marker-end:url(#arrow)}
 </style>
 <defs>
  <marker id="arrow" viewBox="0 0 10 10" refX="7" refY="5" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
   <path d="M0 0 L10 5 L0 10 z" fill="#555"/>
  </marker>
 </defs>
 <text x="15" y="28" class="title">RAG + Caching Overview</text>
 <!-- Client -->
 <rect x="40" y="70" width="140" height="50" rx="6" class="stage"/>
 <text x="110" y="100" text-anchor="middle">User Request</text>
 <!-- Intention -->
 <rect x="220" y="70" width="170" height="50" rx="6" class="stage"/>
 <text x="305" y="95" text-anchor="middle">Intention Normalization</text>
 <!-- Cache decision -->
 <polygon points="430,70 470,95 430,120 390,95" class="decision"/>
 <text x="430" y="92" text-anchor="middle">Cache</text>
 <text x="430" y="106" text-anchor="middle">Hit?</text>
 <!-- Retrieval -->
 <rect x="500" y="30" width="140" height="50" rx="6" class="stage"/>
 <text x="570" y="55" text-anchor="middle">Hybrid Retrieval</text>
 <!-- Enrich decision -->
 <polygon points="680,30 720,55 680,80 640,55" class="decision"/>
 <text x="680" y="52" text-anchor="middle">Need</text>
 <text x="680" y="66" text-anchor="middle">Enrich?</text>
 <!-- Provider calls -->
 <rect x="740" y="10" width="150" height="50" rx="6" class="stage"/>
 <text x="815" y="40" text-anchor="middle">Provider Calls</text>
 <!-- Context Assembly -->
 <rect x="500" y="140" width="150" height="50" rx="6" class="stage"/>
 <text x="575" y="170" text-anchor="middle">Context Assembly</text>
 <!-- Generation -->
 <rect x="700" y="140" width="150" height="50" rx="6" class="stage"/>
 <text x="775" y="170" text-anchor="middle">LLM Generation</text>
 <!-- Post process -->
 <rect x="900" y="140" width="150" height="50" rx="6" class="stage"/>
 <text x="975" y="170" text-anchor="middle">Post-Process</text>
 <!-- Cache store -->
 <rect x="900" y="230" width="150" height="50" rx="6" class="stage"/>
 <text x="975" y="260" text-anchor="middle">Cache Store</text>
 <!-- Cache group -->
 <rect x="40" y="300" width="380" height="190" class="group"/>
 <text x="55" y="317">Caches</text>
 <rect x="70" y="330" width="120" height="45" rx="6" class="cache"/>
 <text x="130" y="358" text-anchor="middle">Retrieval Set</text>
 <rect x="220" y="330" width="120" height="45" rx="6" class="cache"/>
 <text x="280" y="358" text-anchor="middle">Provider Items</text>
 <rect x="70" y="390" width="120" height="45" rx="6" class="cache"/>
 <text x="130" y="418" text-anchor="middle">Semantic Answer</text>
 <rect x="220" y="390" width="120" height="45" rx="6" class="cache"/>
 <text x="280" y="418" text-anchor="middle">Delta Patches</text>
 <!-- Data group -->
 <rect x="470" y="300" width="340" height="190" class="group"/>
 <text x="485" y="317">Persistent Stores</text>
 <rect x="500" y="330" width="120" height="50" rx="6" class="store"/>
 <text x="560" y="360" text-anchor="middle">Relational / Core</text>
 <rect x="650" y="330" width="120" height="50" rx="6" class="store"/>
 <text x="710" y="360" text-anchor="middle">Blob Media</text>
 <rect x="575" y="400" width="120" height="50" rx="6" class="store"/>
 <text x="635" y="430" text-anchor="middle">Search Index</text>
 <!-- Edges -->
 <path class="flow" d="M180 95 L220 95"/>
 <path class="flow" d="M390 95 L390 95 L430 95"/>
 <path class="flow" d="M470 95 L500 55"/>
 <path class="flow" d="M640 55 L640 55 L680 55"/>
 <path class="flow" d="M720 55 L740 40"/>
 <path class="flow" d="M430 95 L500 165"/>
 <path class="flow" d="M650 165 L700 165"/>
 <path class="flow" d="M850 165 L900 165"/>
 <path class="flow" d="M975 190 L975 230"/>
 <path class="flow" d="M815 60 L775 140"/>
 <path class="flow" d="M560 190 L560 330"/>
 <path class="flow" d="M715 190 L635 400"/>
 <path class="flow" d="M975 280 L400 355"/>
 <path class="flow" d="M500 360 L470 360"/>
 </svg>